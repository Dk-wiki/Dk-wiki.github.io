<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="Web拟态防御题型初探网络空间拟态防御 例题2019_RCTF Calcalcalc题目描述 123We implemented a new-generation calculator here!With the guidance of Cyber Mimic Defense, we developed this absolutely safe calculator and nobody can">
<meta property="og:type" content="article">
<meta property="og:title" content="Web拟态防御题型初探">
<meta property="og:url" content="/2020/02/17/Web拟态防御题型初探/index.html">
<meta property="og:site_name" content="dkk-blog">
<meta property="og:description" content="Web拟态防御题型初探网络空间拟态防御 例题2019_RCTF Calcalcalc题目描述 123We implemented a new-generation calculator here!With the guidance of Cyber Mimic Defense, we developed this absolutely safe calculator and nobody can">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2020-02-17T15:38:58.730Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Web拟态防御题型初探">
<meta name="twitter:description" content="Web拟态防御题型初探网络空间拟态防御 例题2019_RCTF Calcalcalc题目描述 123We implemented a new-generation calculator here!With the guidance of Cyber Mimic Defense, we developed this absolutely safe calculator and nobody can">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Web拟态防御题型初探</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2019/11/25/2019NCTF-Web-Wp/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=/2020/02/17/Web拟态防御题型初探/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=/2020/02/17/Web拟态防御题型初探/&text=Web拟态防御题型初探"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=/2020/02/17/Web拟态防御题型初探/&title=Web拟态防御题型初探"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=/2020/02/17/Web拟态防御题型初探/&is_video=false&description=Web拟态防御题型初探"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Web拟态防御题型初探&body=Check out this article: /2020/02/17/Web拟态防御题型初探/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=/2020/02/17/Web拟态防御题型初探/&title=Web拟态防御题型初探"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=/2020/02/17/Web拟态防御题型初探/&title=Web拟态防御题型初探"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=/2020/02/17/Web拟态防御题型初探/&title=Web拟态防御题型初探"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=/2020/02/17/Web拟态防御题型初探/&title=Web拟态防御题型初探"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=/2020/02/17/Web拟态防御题型初探/&name=Web拟态防御题型初探&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web拟态防御题型初探"><span class="toc-number">1.</span> <span class="toc-text">Web拟态防御题型初探</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#例题"><span class="toc-number">1.1.</span> <span class="toc-text">例题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2019-RCTF-Calcalcalc"><span class="toc-number">1.1.1.</span> <span class="toc-text">2019_RCTF Calcalcalc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#python"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">python</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2019-0CTF-114514calcalcalc"><span class="toc-number">1.1.2.</span> <span class="toc-text">2019_0CTF 114514calcalcalc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2019-De1ctf-9calc"><span class="toc-number">1.1.3.</span> <span class="toc-text">2019_De1ctf 9calc</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Web拟态防御题型初探
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">dkk-blog</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-02-17T06:34:37.000Z" itemprop="datePublished">2020-02-17</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="Web拟态防御题型初探"><a href="#Web拟态防御题型初探" class="headerlink" title="Web拟态防御题型初探"></a>Web拟态防御题型初探</h1><p><a href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1/20288376?fr=aladdin" target="_blank" rel="noopener">网络空间拟态防御</a></p>
<h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="2019-RCTF-Calcalcalc"><a href="#2019-RCTF-Calcalcalc" class="headerlink" title="2019_RCTF Calcalcalc"></a>2019_RCTF Calcalcalc</h3><p>题目描述</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">We implemented a new-generation calculator here!</span><br><span class="line">With the guidance of Cyber Mimic Defense, we developed this absolutely safe calculator and nobody can break it. The expression will be calculated by three different backends to make sure that the result is absolutely correct.</span><br><span class="line">You can check the [source](https://github.com/zsxsoft/my-ctf-challenges/tree/master/rctf2019/calcalcalc) code here.</span><br></pre></td></tr></table></figure>

<p>使用了三种后端：nodejs、php、python,我们输入的参数，会分别进入3种后端进行执行，如果3种后端最后的返回值不同，那么则认定为无效，显示<code>That&#39;s classified information. - Asahina Mikuru</code>。如果返回值一致，认定为安全，则将执行结果返回。<br>题目给了我们后端源码</p>
<h4 id="python"><a href="#python" class="headerlink" title="python"></a>python</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">import</span> bson</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> __builtins__[<span class="string">'exec'</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/", methods=["POST"])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate</span><span class="params">()</span>:</span></span><br><span class="line">    data = request.get_data()</span><br><span class="line">    expr = bson.BSON(data).decode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bson.BSON.encode(&#123;</span><br><span class="line">      <span class="string">"ret"</span>: str(eval(str(expr[<span class="string">'expression'</span>])))</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="2019-0CTF-114514calcalcalc"><a href="#2019-0CTF-114514calcalcalc" class="headerlink" title="2019_0CTF 114514calcalcalc"></a>2019_0CTF 114514calcalcalc</h3><h3 id="2019-De1ctf-9calc"><a href="#2019-De1ctf-9calc" class="headerlink" title="2019_De1ctf 9calc"></a>2019_De1ctf 9calc</h3>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web拟态防御题型初探"><span class="toc-number">1.</span> <span class="toc-text">Web拟态防御题型初探</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#例题"><span class="toc-number">1.1.</span> <span class="toc-text">例题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2019-RCTF-Calcalcalc"><span class="toc-number">1.1.1.</span> <span class="toc-text">2019_RCTF Calcalcalc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#python"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">python</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2019-0CTF-114514calcalcalc"><span class="toc-number">1.1.2.</span> <span class="toc-text">2019_0CTF 114514calcalcalc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2019-De1ctf-9calc"><span class="toc-number">1.1.3.</span> <span class="toc-text">2019_De1ctf 9calc</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=/2020/02/17/Web拟态防御题型初探/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=/2020/02/17/Web拟态防御题型初探/&text=Web拟态防御题型初探"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=/2020/02/17/Web拟态防御题型初探/&title=Web拟态防御题型初探"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=/2020/02/17/Web拟态防御题型初探/&is_video=false&description=Web拟态防御题型初探"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Web拟态防御题型初探&body=Check out this article: /2020/02/17/Web拟态防御题型初探/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=/2020/02/17/Web拟态防御题型初探/&title=Web拟态防御题型初探"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=/2020/02/17/Web拟态防御题型初探/&title=Web拟态防御题型初探"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=/2020/02/17/Web拟态防御题型初探/&title=Web拟态防御题型初探"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=/2020/02/17/Web拟态防御题型初探/&title=Web拟态防御题型初探"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=/2020/02/17/Web拟态防御题型初探/&name=Web拟态防御题型初探&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 dkk
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/projects_url">Projects</a></li>
        
      </ul>
    </nav>
  </div>
  <br />
  <img src="https://static.dy208.cn/o_1dfilp8ruo521thr1hvf18ji17soa.png">
<a href="http://www.beian.miit.gov.cn/"  style="color:#fdebe7" target="_blank" text-align="center">苏ICP备19045774号-1</a>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<!-- clipboard -->

  <script src="/lib/clipboard/clipboard.min.js"></script>
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight .code pre").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>

<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
